<!doctype html>
<html lang="ar" dir="rtl" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ููุตุฉ ูุงูุณ | ุฑูุงุถูุงุช ุซุงูุซ ุงุจุชุฏุงุฆู</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">

  <style>
    * { font-family: 'Tajawal', sans-serif; }
    body { background: radial-gradient(1200px 600px at 80% -10%, rgba(217,70,239,0.10), transparent 55%),
                   radial-gradient(900px 500px at -10% 10%, rgba(59,130,246,0.10), transparent 55%),
                   #f8fafc; }
    .chip { border: 1px solid rgba(148,163,184,0.7); background: rgba(255,255,255,0.75); }
    .tab-btn[aria-selected="true"] { background: rgba(99,102,241,0.10); border-color: rgba(99,102,241,0.45); }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }

    /* Print */
    @media print {
      body { background: #fff !important; }
      .no-print { display: none !important; }
      .print-area { box-shadow: none !important; border: none !important; }
      .print-area * { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      .page-break { break-after: page; page-break-after: always; }
      .avoid-break { break-inside: avoid; page-break-inside: avoid; }
      a:link, a:visited { color: #111827; text-decoration: none; }
      [contenteditable="true"] { outline: none !important; }
    }
  </style>
</head>

<body class="min-h-screen">
  <div class="max-w-7xl mx-auto p-4 sm:p-6">
    <!-- Header -->
    <header class="no-print flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
      <div class="flex items-center gap-3">
        <div class="w-11 h-11 rounded-2xl bg-white shadow-sm border border-slate-200 flex items-center justify-center overflow-hidden">
          <img class="app-logo w-10 h-10 object-contain" alt="ุดุนุงุฑ"/>
        </div>
        <div>
          <h1 class="text-xl sm:text-2xl font-extrabold text-slate-900">ููุตุฉ ูุงูุณ โ ุฑูุงุถูุงุช ุซุงูุซ ุงุจุชุฏุงุฆู</h1>
          <p class="text-slate-600 text-sm">ุฎุทุฉ ุนูุงุฌูุฉ + ุฅุซุฑุงุฆูุฉ + ุชุฏุฑูุจุงุช + ุงุฎุชุจุงุฑุงุช ุฃุณุจูุนูุฉ (ุงุฎุชูุงุฑ ูู ูุชุนุฏุฏ) โ ุฌุงูุฒ ููุทุจุงุนุฉ</p>
        </div>
      </div>

      <div class="flex flex-wrap gap-2">
        <button id="btnPrint" class="chip px-3 py-2 rounded-xl text-sm font-bold hover:bg-white">๐จ๏ธ ุทุจุงุนุฉ</button>
        <button id="btnExport" class="chip px-3 py-2 rounded-xl text-sm font-bold hover:bg-white">โฌ๏ธ ุชุตุฏูุฑ ุงูุจูุงูุงุช</button>
        <label class="chip px-3 py-2 rounded-xl text-sm font-bold hover:bg-white cursor-pointer">
          โฌ๏ธ ุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช
          <input id="importFile" type="file" accept="application/json" class="hidden"/>
        </label>
        <button id="btnResetAll" class="chip px-3 py-2 rounded-xl text-sm font-bold hover:bg-white">โฉ๏ธ ุฅุนุงุฏุฉ ุถุจุท</button>
      </div>
    </header>

    <!-- Tabs -->
    <nav class="no-print mt-4 flex flex-wrap gap-2">
      <button class="tab-btn chip px-3 py-2 rounded-xl text-sm font-bold" data-tab="dashboard" aria-selected="true">๐ ุงูุฑุฆูุณูุฉ</button>
      <button class="tab-btn chip px-3 py-2 rounded-xl text-sm font-bold" data-tab="plan" aria-selected="false">๐ ุงูุฎุทุฉ ุงูุฑุณููุฉ</button>
      <button class="tab-btn chip px-3 py-2 rounded-xl text-sm font-bold" data-tab="training" aria-selected="false">๐ฏ ุงูุชุฏุฑูุจ ุงููููู</button>
      <button class="tab-btn chip px-3 py-2 rounded-xl text-sm font-bold" data-tab="quiz" aria-selected="false">๐งช ุงุฎุชุจุงุฑ ุฃุณุจูุนู</button>
      <button class="tab-btn chip px-3 py-2 rounded-xl text-sm font-bold" data-tab="bank" aria-selected="false">๐๏ธ ุจูู ุงูุฃุณุฆูุฉ</button>
    </nav>

    <!-- Content -->
    <main class="mt-4">
      <!-- Dashboard -->
      <section id="tab-dashboard" class="print-area bg-white border border-slate-200 rounded-3xl shadow-sm p-4 sm:p-6">
        <div class="grid lg:grid-cols-3 gap-4">
          <div class="lg:col-span-2">
            <div class="flex items-start justify-between gap-3">
              <div class="flex items-start gap-3">
                <img class="app-logo w-12 h-12 object-contain rounded-2xl border border-slate-200 bg-white p-1" alt="ุดุนุงุฑ"/>
                <div>
                  <h2 class="text-lg font-extrabold text-slate-900">ุจูุงูุงุช ุงูุบูุงู</h2>
                <p class="text-slate-600 text-sm mt-1">ุงูุชุจ ุงูุจูุงูุงุช ูุฑุฉ ูุงุญุฏุฉ โ ุชูุณุชุฎุฏู ุชููุงุฆููุง ูู ุงูุทุจุงุนุฉ ุฏุงุฎู ุงูุฎุทุฉ ูุงูุงุฎุชุจุงุฑุงุช.</p>
                </div>
              </div>
              <button id="btnPrintCover" class="no-print chip px-3 py-2 rounded-xl text-sm font-bold hover:bg-white">๐จ๏ธ ุทุจุงุนุฉ ุงูุบูุงู</button>
            </div>

            <div class="mt-4 grid sm:grid-cols-2 gap-3">
              <div>
                <label class="text-sm font-bold text-slate-700">ุงุณู ุงููุฏุฑุณุฉ</label>
                <input id="schoolName" class="mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-200" placeholder="ูุซุงู: ูุฏุฑุณุฉ __________" />
              </div>
              <div>
                <label class="text-sm font-bold text-slate-700">ุงูุตู / ุงูุดุนุจุฉ</label>
                <input id="className" class="mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-200" placeholder="ูุซุงู: ุซุงูุซ (ุจ)" />
              </div>
              <div>
                <label class="text-sm font-bold text-slate-700">ุงุณู ุงููุนูู</label>
                <input id="teacherName" class="mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-200" placeholder="ูุซุงู: ุฃ/ ________" />
              </div>
              <div>
                <label class="text-sm font-bold text-slate-700">ุงููุตู ุงูุฏุฑุงุณู</label>
                <input id="termName" class="mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-200" placeholder="ูุซุงู: ุงููุตู ุงูุซุงูู" />
              </div>
              <div>
                <label class="text-sm font-bold text-slate-700">ุงูุนุงู ุงูุฏุฑุงุณู</label>
                <input id="yearName" class="mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-200" placeholder="ูุซุงู: 1447ูู" />
              </div>
              <div>
                <label class="text-sm font-bold text-slate-700">ุงุณู ุงูุทุงูุจ (ููุงุฎุชุจุงุฑุงุช)</label>
                <input id="studentName" class="mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-200" placeholder="ุงูุชุจ ุงุณูู ููุง" />
              </div>
            </div>

            <div class="mt-4 rounded-2xl border border-slate-200 bg-slate-50 p-4">
              <h3 class="font-extrabold text-slate-900">ุทุฑููุฉ ุงูุงุณุชุฎุฏุงู ุงูุณุฑูุนุฉ</h3>
              <ol class="mt-2 text-slate-700 text-sm list-decimal pr-5 space-y-1">
                <li>ุงุฐูุจ ุฅูู <b>ุงูุฎุทุฉ ุงูุฑุณููุฉ</b> ูุงุฎุชุฑ (ุนูุงุฌู/ุฅุซุฑุงุฆู) ุซู ุงุทุจุน.</li>
                <li>ุงุฐูุจ ุฅูู <b>ุงูุชุฏุฑูุจ ุงููููู</b> ูุงุฎุชุฑ ุงูููุงุฑุฉ + ุฑูู ุงูุฃุณุจูุน ุซู ุฃูุดุฆ ุชุฏุฑูุจูุง ุฌุงูุฒูุง.</li>
                <li>ุงุฐูุจ ุฅูู <b>ุงุฎุชุจุงุฑ ุฃุณุจูุนู</b> ูุงุฎุชุฑ ุงูููุงุฑุฉ + ุฑูู ุงูุฃุณุจูุน ุซู ุงุทุจุน ูููุฐุฌ ุงูุงุฎุชูุงุฑ ูู ูุชุนุฏุฏ.</li>
                <li>ุงุณุชุฎุฏู <b>ุชุตุฏูุฑ ุงูุจูุงูุงุช</b> ูุญูุธ ุชุนุฏููุงุชู (ุฎุทุฉ/ุจูุงูุงุช ุงูุบูุงู) ูุงุณุชูุฑุงุฏูุง ูุงุญููุง.</li>
              </ol>
            </div>
          </div>

          <aside class="lg:col-span-1">
            <div class="rounded-3xl border border-slate-200 bg-white p-4">
              <h3 class="text-lg font-extrabold text-slate-900">ุงูุฌุงูุฒูุฉ</h3>
              <p class="text-slate-600 text-sm mt-1">ุงุฎุชุฑ ููุท ุงูุฎุทุฉ ูุงูุชุฑุงุถููุงุช ุงูุทุจุงุนุฉ.</p>

              <div class="mt-4 space-y-3">
                <div>
                  <label class="text-sm font-bold text-slate-700">ููุน ุงูุฎุทุฉ</label>
                  <select id="defaultTrack" class="mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 bg-white">
                    <option value="ุนูุงุฌู">ุนูุงุฌู</option>
                    <option value="ุฅุซุฑุงุฆู">ุฅุซุฑุงุฆู</option>
                  </select>
                </div>

                <div>
                  <label class="text-sm font-bold text-slate-700">ุฅุธูุงุฑ ูููุฐุฌ ุงูุฅุฌุงุจุฉ (ูู ุงูุงุฎุชุจุงุฑุงุช)</label>
                  <select id="defaultAnswerKey" class="mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 bg-white">
                    <option value="hide">ุฅุฎูุงุก</option>
                    <option value="show">ุฅุธูุงุฑ</option>
                  </select>
                </div>

                <div class="rounded-2xl bg-indigo-50 border border-indigo-100 p-3 text-sm text-indigo-900">
                  <div class="font-extrabold">ููุงุญุธุฉ</div>
                  <div class="mt-1">ููุงุฐุฌ ุงูุงุฎุชุจุงุฑุงุช ุชููุดุฃ ุจุทุฑููุฉ ุซุงุจุชุฉ ุญุณุจ <b>ุฑูู ุงูุฃุณุจูุน</b> ุญุชู ุชุญุตู ุนูู ูููุฐุฌ ุฌุฏูุฏ ูู ุฃุณุจูุน.</div>
                </div>

                <button id="btnGoPlan" class="no-print w-full rounded-2xl bg-indigo-600 hover:bg-indigo-700 text-white font-extrabold px-4 py-3">
                  ุงูุชูู ุฅูู ุงูุฎุทุฉ ุงูุฑุณููุฉ
                </button>
              </div>
            </div>

            <div class="mt-4 rounded-3xl border border-slate-200 bg-white p-4">
              <h3 class="text-lg font-extrabold text-slate-900">ุงูุชุฐููู</h3>
              <p class="text-slate-600 text-sm mt-1">ูุธูุฑ ูู ุฃุณูู ูู ุตูุญุฉ ุนูุฏ ุงูุทุจุงุนุฉ.</p>
              <textarea id="footerText" class="mt-3 w-full min-h-[92px] rounded-2xl border border-slate-200 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-200" placeholder="ูุซุงู: ุฅุนุฏุงุฏ: ุฃ/ูุงุทูุฉ ูุฒุงุฒู | ููุชูู ูุนููู ููุนููุงุช ุงูุฑูุงุถูุงุช | ุงูููุชูู ุงูุชูุงุนูู"></textarea>
            </div>
          </aside>
        </div>
      </section>

      <!-- Plan -->
      <section id="tab-plan" class="hidden print-area bg-white border border-slate-200 rounded-3xl shadow-sm p-4 sm:p-6">
        <div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
          <div>
            <h2 class="text-lg font-extrabold text-slate-900">ุงูุฎุทุฉ ุงูุฑุณููุฉ ุงูุฌุงูุฒุฉ ููุทุจุงุนุฉ</h2>
            <p class="text-slate-600 text-sm mt-1">ุฃุนูุฏุฉ: (ุงูุฃูุฏุงู/ุงูุฅุฌุฑุงุกุงุช/ุงููุณุคูู/ุงูุฒูู/ุงููุคุดุฑ/ุฃุฏุงุฉ ุงูููุงุณ). ููููู ุชุนุฏูู ุฃู ุฎููุฉ ุซู ูุชู ุงูุญูุธ ุชููุงุฆููุง.</p>
          </div>
          <div class="no-print flex flex-wrap gap-2">
            <button id="btnPrintPlan" class="chip px-3 py-2 rounded-xl text-sm font-bold hover:bg-white">๐จ๏ธ ุทุจุงุนุฉ ุงูุฎุทุฉ</button>
            <button id="btnResetPlan" class="chip px-3 py-2 rounded-xl text-sm font-bold hover:bg-white">โฉ๏ธ ุงุณุชุนุงุฏุฉ ุงูุฎุทุฉ ุงูุงูุชุฑุงุถูุฉ</button>
          </div>
        </div>

        <div class="no-print mt-4 grid sm:grid-cols-4 gap-3">
          <div>
            <label class="text-sm font-bold text-slate-700">ููุน ุงูุฎุทุฉ</label>
            <select id="planTrack" class="mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 bg-white"></select>
          </div>
          <div>
            <label class="text-sm font-bold text-slate-700">ุงููุฌุงู</label>
            <select id="planDomain" class="mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 bg-white"></select>
          </div>
          <div>
            <label class="text-sm font-bold text-slate-700">ุจุญุซ</label>
            <input id="planSearch" class="mt-1 w-full rounded-xl border border-slate-200 px-3 py-2" placeholder="ุงูุชุจ ูููุฉ ูู ุงููุฏู ุฃู ุงูููุงุฑุฉ..." />
          </div>
          <div>
            <label class="text-sm font-bold text-slate-700">ูุฏู ุงูุฅุชูุงู</label>
            <select id="planTarget" class="mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 bg-white">
              <option value="80">ูจููช</option>
              <option value="85">ูจูฅูช</option>
              <option value="90">ูฉููช</option>
              <option value="95">ูฉูฅูช</option>
            </select>
          </div>
        </div>

        <!-- Cover for print -->
        <div class="mt-6 rounded-2xl border border-slate-200 p-4">
          <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3">
            <div>
              <div class="flex items-start gap-3">
              <img class="app-logo w-14 h-14 object-contain rounded-2xl border border-slate-200 bg-white p-1" alt="ุดุนุงุฑ"/>
              <div>
                <div class="text-sm text-slate-600">ุจูุงูุงุช</div>
              <div class="text-xl font-extrabold text-slate-900">ุฎุทุฉ ูุงูุณ โ ุฑูุงุถูุงุช ุซุงูุซ ุงุจุชุฏุงุฆู</div>
              <div class="mt-1 text-sm text-slate-700" id="planMeta"></div>
              </div>
            </div>
            </div>
            <div class="text-sm text-slate-700">
              <div><span class="text-slate-500">ุงูุชุงุฑูุฎ:</span> <span id="todayDate" class="font-bold"></span></div>
              <div class="mt-1"><span class="text-slate-500">ููุน ุงูุฎุทุฉ:</span> <span id="planMetaTrack" class="font-extrabold"></span></div>
            </div>
          </div>
        </div>

        <div class="mt-4 overflow-x-auto rounded-2xl border border-slate-200">
          <table class="w-full text-sm">
            <thead class="bg-slate-50">
              <tr class="text-slate-800">
                <th class="p-3 border-b border-slate-200 text-right">ุงูููุงุฑุฉ</th>
                <th class="p-3 border-b border-slate-200 text-right">ุงูุฃูุฏุงู</th>
                <th class="p-3 border-b border-slate-200 text-right">ุงูุฅุฌุฑุงุกุงุช</th>
                <th class="p-3 border-b border-slate-200 text-right">ุงููุณุคูู</th>
                <th class="p-3 border-b border-slate-200 text-right">ุงูุฒูู</th>
                <th class="p-3 border-b border-slate-200 text-right">ุงููุคุดุฑ</th>
                <th class="p-3 border-b border-slate-200 text-right">ุฃุฏุงุฉ ุงูููุงุณ</th>
              </tr>
            </thead>
            <tbody id="planBody"></tbody>
          </table>
        </div>

        <div class="mt-6 text-sm text-slate-600">
          <div class="font-extrabold text-slate-900">ููุงุญุธุงุช ุชูููุฐ ูุฎุชุตุฑุฉ</div>
          <ul class="list-disc pr-6 mt-2 space-y-1">
            <li>ุทุจูู ุฑูุชูู ุซุงุจุช: (ุงุณุชุฑุฌุงุน ุณุฑูุน โ ูุซุงู ูุฑูุฒ โ ุชุฏุฑูุจ ููุฌูู โ ุชุทุจูู ูุณุชูู โ ุจุทุงูุฉ ุฎุฑูุฌ).</li>
            <li>ุงุฌุนู ุงูุงุฎุชุจุงุฑ ุงูุฃุณุจูุนู ูู (5โ10) ุฃุณุฆูุฉ ุงุฎุชูุงุฑ ูู ูุชุนุฏุฏ ููู ููุงุฑุฉ.</li>
            <li>ุญููู ุงูุฃุฎุทุงุก ุญุณุจ ููุนูุง: (ููููู/ุฅุฌุฑุงุก/ูุฑุงุกุฉ ูุณุฃูุฉ/ุณูู) ุซู ุนุฏูู ุงูุฅุฌุฑุงุกุงุช.</li>
          </ul>
        </div>
      </section>

      <!-- Training -->
      <section id="tab-training" class="hidden print-area bg-white border border-slate-200 rounded-3xl shadow-sm p-4 sm:p-6">
        <div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
          <div>
            <h2 class="text-lg font-extrabold text-slate-900">ุงูุชุฏุฑูุจ ุงููููู โ ุฑูุชูู ูุงูุณ</h2>
            <p class="text-slate-600 text-sm mt-1">ููุดุฆ ูู ุชุฏุฑูุจูุง ุฌุงูุฒูุง ููู ููุงุฑุฉ (ุงุณุชุฑุฌุงุน/ููุฌูู/ูุณุชูู/ุจุทุงูุฉ ุฎุฑูุฌ) ูู ุจูู ุงูุฃุณุฆูุฉ.</p>
          </div>
          <div class="no-print flex flex-wrap gap-2">
            <button id="btnPrintTraining" class="chip px-3 py-2 rounded-xl text-sm font-bold hover:bg-white">๐จ๏ธ ุทุจุงุนุฉ ุงูุชุฏุฑูุจ</button>
          </div>
        </div>

        <div class="no-print mt-4 grid sm:grid-cols-4 gap-3">
          <div class="sm:col-span-2">
            <label class="text-sm font-bold text-slate-700">ุงุฎุชุฑ ุงูููุงุฑุฉ</label>
            <select id="trainingSkill" class="mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 bg-white"></select>
          </div>
          <div>
            <label class="text-sm font-bold text-slate-700">ููุน ุงูุชุฏุฑูุจ</label>
            <select id="trainingTrack" class="mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 bg-white">
              <option value="ุนูุงุฌู">ุนูุงุฌู</option>
              <option value="ุฅุซุฑุงุฆู">ุฅุซุฑุงุฆู</option>
            </select>
          </div>
          <div>
            <label class="text-sm font-bold text-slate-700">ุฑูู ุงูุฃุณุจูุน</label>
            <input id="trainingWeek" type="number" min="1" value="1" class="mt-1 w-full rounded-xl border border-slate-200 px-3 py-2" />
          </div>
          <div class="sm:col-span-2">
            <label class="text-sm font-bold text-slate-700">ุนุฑุถ ูููุฐุฌ ุงูุฅุฌุงุจุฉ</label>
            <select id="trainingAnswers" class="mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 bg-white">
              <option value="hide">ุฅุฎูุงุก</option>
              <option value="show">ุฅุธูุงุฑ</option>
            </select>
          </div>
          <div class="sm:col-span-2 flex items-end gap-2">
            <button id="btnGenerateTraining" class="w-full rounded-2xl bg-indigo-600 hover:bg-indigo-700 text-white font-extrabold px-4 py-3">
              ุฅูุดุงุก ุงูุชุฏุฑูุจ
            </button>
          </div>
        </div>

        <div class="mt-6 rounded-2xl border border-slate-200 p-4">
          <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3">
            <div>
              <div class="flex items-start gap-3">
                <img class="app-logo w-12 h-12 object-contain rounded-2xl border border-slate-200 bg-white p-1" alt="ุดุนุงุฑ"/>
                <div>
                  <div class="text-xl font-extrabold text-slate-900" id="trainingTitle">ุงุฎุชุฑ ููุงุฑุฉ ุซู ุงุถุบุท "ุฅูุดุงุก ุงูุชุฏุฑูุจ"</div>
              <div class="text-sm text-slate-600 mt-1" id="trainingMeta"></div>
                </div>
              </div>
            </div>
            <div class="text-sm text-slate-700">
              <div><span class="text-slate-500">ุงูุทุงูุจ:</span> <span id="trainingStudent" class="font-bold"></span></div>
              <div class="mt-1"><span class="text-slate-500">ุงูุชุงุฑูุฎ:</span> <span id="trainingDate" class="font-bold"></span></div>
            </div>
          </div>
        </div>

        <div id="trainingContent" class="mt-4 space-y-4"></div>
      </section>

      <!-- Quiz -->
      <section id="tab-quiz" class="hidden print-area bg-white border border-slate-200 rounded-3xl shadow-sm p-4 sm:p-6">
        <div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
          <div>
            <h2 class="text-lg font-extrabold text-slate-900">ุงุฎุชุจุงุฑ ุฃุณุจูุนู โ ุงุฎุชูุงุฑ ูู ูุชุนุฏุฏ</h2>
            <p class="text-slate-600 text-sm mt-1">ุงุฎุชุฑ ุงูููุงุฑุฉ ุซู ุงุทุจุน ูููุฐุฌูุง ุฃุณุจูุนููุง (ูุชุบูุฑ ุญุณุจ ุฑูู ุงูุฃุณุจูุน).</p>
          </div>
          <div class="no-print flex flex-wrap gap-2">
            <button id="btnPrintQuiz" class="chip px-3 py-2 rounded-xl text-sm font-bold hover:bg-white">๐จ๏ธ ุทุจุงุนุฉ ุงูุงุฎุชุจุงุฑ</button>
          </div>
        </div>

        <div class="no-print mt-4 grid sm:grid-cols-5 gap-3">
          <div class="sm:col-span-2">
            <label class="text-sm font-bold text-slate-700">ุงุฎุชุฑ ุงูููุงุฑุฉ</label>
            <select id="quizSkill" class="mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 bg-white"></select>
          </div>
          <div>
            <label class="text-sm font-bold text-slate-700">ุฑูู ุงูุฃุณุจูุน</label>
            <input id="quizWeek" type="number" min="1" value="1" class="mt-1 w-full rounded-xl border border-slate-200 px-3 py-2" />
          </div>
          <div>
            <label class="text-sm font-bold text-slate-700">ุนุฏุฏ ุงูุฃุณุฆูุฉ</label>
            <select id="quizCount" class="mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 bg-white">
              <option value="5">ูฅ</option>
              <option value="10" selected>ูกู</option>
            </select>
          </div>
          <div>
            <label class="text-sm font-bold text-slate-700">ูููุฐุฌ ุงูุฅุฌุงุจุฉ</label>
            <select id="quizAnswers" class="mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 bg-white">
              <option value="hide">ุฅุฎูุงุก</option>
              <option value="show">ุฅุธูุงุฑ</option>
            </select>
          </div>

          <div class="sm:col-span-5">
            <button id="btnGenerateQuiz" class="w-full rounded-2xl bg-indigo-600 hover:bg-indigo-700 text-white font-extrabold px-4 py-3">
              ุฅูุดุงุก ุงูุงุฎุชุจุงุฑ
            </button>
          </div>
        </div>

        <div class="mt-6 rounded-2xl border border-slate-200 p-4">
          <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3">
            <div>
              <div class="text-xl font-extrabold text-slate-900" id="quizTitle">ุงุฎุชุฑ ููุงุฑุฉ ุซู ุงุถุบุท "ุฅูุดุงุก ุงูุงุฎุชุจุงุฑ"</div>
              <div class="text-sm text-slate-600 mt-1" id="quizMeta"></div>
            </div>
            <div class="text-sm text-slate-700">
              <div><span class="text-slate-500">ุงุณู ุงูุทุงูุจ:</span> <span class="font-bold" id="quizStudent"></span></div>
              <div class="mt-1"><span class="text-slate-500">ุงูุชุงุฑูุฎ:</span> <span class="font-bold" id="quizDate"></span></div>
            </div>
          </div>
        </div>

        <div id="quizContent" class="mt-4"></div>
      </section>

      <!-- Bank -->
      <section id="tab-bank" class="hidden print-area bg-white border border-slate-200 rounded-3xl shadow-sm p-4 sm:p-6">
        <div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
          <div>
            <h2 class="text-lg font-extrabold text-slate-900">ุจูู ุงูุฃุณุฆูุฉ</h2>
            <p class="text-slate-600 text-sm mt-1">ุงุณุชุนุฑุงุถ ุงูุฃุณุฆูุฉ ููู ููุงุฑุฉ. ููููู ุฅุถุงูุฉ ุฃุณุฆูุชู ุฏุงุฎู ุงูููุฏ ูุงุญููุง ุจุณูููุฉ.</p>
          </div>
          <div class="no-print flex flex-wrap gap-2">
            <button id="btnPrintBank" class="chip px-3 py-2 rounded-xl text-sm font-bold hover:bg-white">๐จ๏ธ ุทุจุงุนุฉ ุจูู ุงูุฃุณุฆูุฉ</button>
          </div>
        </div>

        <div class="no-print mt-4 grid sm:grid-cols-3 gap-3">
          <div class="sm:col-span-2">
            <label class="text-sm font-bold text-slate-700">ุงุฎุชุฑ ุงูููุงุฑุฉ</label>
            <select id="bankSkill" class="mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 bg-white"></select>
          </div>
          <div>
            <label class="text-sm font-bold text-slate-700">ุจุญุซ ุฏุงุฎู ุงูุฃุณุฆูุฉ</label>
            <input id="bankSearch" class="mt-1 w-full rounded-xl border border-slate-200 px-3 py-2" placeholder="ูุซุงู: ุชูุฑูุจ / ูุญูุท / 10ร10" />
          </div>
        </div>

        <div id="bankContent" class="mt-6"></div>
      </section>
    </main>

    <footer class="mt-6 text-center text-xs text-slate-500">
      <div id="footerPreview"></div>
    </footer>
  </div>

<script>
/* =========================
   ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ (ุงูููุงุฑุงุช + ุงูุฎุทุฉ + ุจูู ุงูุฃุณุฆูุฉ)
   ========================= */

const SKILLS = [
  { id:"numbers4", domain:"ุงููุฌุงู 1: ุงูุฃุนุฏุงุฏ ูุงูุนูููุงุช", title:"ุงูุฃุนุฏุงุฏ ุถูู ุฃุฑุจุน ููุงุฒู (ูููุฉ ููุฒููุฉ/ูุฑุงุกุฉ/ูุชุงุจุฉ/ููุงุฑูุฉ/ุชุฑุชูุจ/ุชูุฑูุจ)" },
  { id:"counting", domain:"ุงููุฌุงู 1: ุงูุฃุนุฏุงุฏ ูุงูุนูููุงุช", title:"ุงูุนุฏ ุถูู ุฃุฑุจุน ููุงุฒู (ุชุตุงุนุฏู/ุชูุงุฒูู/ููุฒู) + ุฒูุฌู/ูุฑุฏู" },
  { id:"fractions", domain:"ุงููุฌุงู 1: ุงูุฃุนุฏุงุฏ ูุงูุนูููุงุช", title:"ูุณูุฑ ุงููุญุฏุฉ ููุถุงุนูุงุชูุง (ุชูุซูู/ูุฑุงุกุฉ/ูุชุงุจุฉ/ููุงุฑูุฉ/ุชุฑุชูุจ)" },
  { id:"addsub", domain:"ุงููุฌุงู 1: ุงูุฃุนุฏุงุฏ ูุงูุนูููุงุช", title:"ุฌูุน ูุทุฑุญ ุถูู ุซูุงุซ ููุงุฒู (ูุน/ุจุฏูู ุฅุนุงุฏุฉ ุงูุชุฌููุน) + ูุณุงุฆู ููุธูุฉ" },
  { id:"muldiv", domain:"ุงููุฌุงู 1: ุงูุฃุนุฏุงุฏ ูุงูุนูููุงุช", title:"ุงูุถุฑุจ ูุงููุณูุฉ ุญุชู 10ร10 (ุญูุงุฆู/ุชูุซูู/ูุณุงุฆู)" },
  { id:"relations", domain:"ุงููุฌุงู 2: ุงูุฌุจุฑ ูุงูุชุญููู", title:"ุงูุนูุงูุงุช ุจูู ุงูุนูููุงุช ุงูุฃุฑุจุน ููุชุงุจุฉ ุงูุฌูู ุงูุนุฏุฏูุฉ" },
  { id:"estimation", domain:"ุงููุฌุงู 1: ุงูุฃุนุฏุงุฏ ูุงูุนูููุงุช", title:"ุงูุชูุฏูุฑ ูุงูุญุณุงุจ ุงูุฐููู ููุนููููุฉ ุงููุงุชุฌ" },
  { id:"patterns", domain:"ุงููุฌุงู 2: ุงูุฌุจุฑ ูุงูุชุญููู", title:"ุงูุฃููุงุท (ุนุฏุฏูุฉ/ุบูุฑ ุนุฏุฏูุฉ/ููุฏุณูุฉ) ูุชูุณูุนูุง" },
  { id:"properties", domain:"ุงููุฌุงู 2: ุงูุฌุจุฑ ูุงูุชุญููู", title:"ุฎุตุงุฆุต ุงูุนูููุงุช (ุงูุตูุฑ/ุงููุงุญุฏ/ุงูุฅุจุฏุงู/ุงูุชุฌููุน/ุงูุชูุฒูุน ุงููุจุณุท)" },
  { id:"geometry", domain:"ุงููุฌุงู 3: ุงูููุฏุณุฉ ูุงูููุงุณ", title:"ุงูุฃุดูุงู ุซูุงุฆูุฉ ูุซูุงุซูุฉ ุงูุฃุจุนุงุฏ + ุงูุชูุงุซู" },
  { id:"perimeter_area", domain:"ุงููุฌุงู 3: ุงูููุฏุณุฉ ูุงูููุงุณ", title:"ุงููุญูุท ูุงููุณุงุญุฉ (ุดุจูุฉ ูุฑุจุนุงุช)" },
  { id:"measurements", domain:"ุงููุฌุงู 3: ุงูููุฏุณุฉ ูุงูููุงุณ", title:"ุงูุทูู/ุงููุชูุฉ/ุงูุณุนุฉ (ุชูุฏูุฑ/ููุงุณ/ููุงุฑูุฉ/ุชุฑุชูุจ/ูุญุฏุงุช)" },
  { id:"money_time", domain:"ุงููุฌุงู 3: ุงูููุฏุณุฉ ูุงูููุงุณ", title:"ุงููููุฏ ุญุชู 9999 + ุงูููุช (ูุฑุงุกุฉ/ูุชุงุจุฉ/ุชูุฏูุฑ ูุฏุฏ)" },
  { id:"stats", domain:"ุงููุฌุงู 4: ุงูุฅุญุตุงุก", title:"ุฌูุน ุงูุจูุงูุงุช ูุชูุซูููุง (ุฃุนูุฏุฉ/ุฑููุฒ/ููุงุท) ููุฑุงุกุชูุง" },
];

const PLAN_TEMPLATES = {
  numbers4: {
    objective: "ูููุฒ ุงููููุฉ ุงูููุฒููุฉ ูุฑูู ูู ุนุฏุฏ ุถูู ุฃุฑุจุน ููุงุฒูุ ูููุซู ุงูุฃุนุฏุงุฏ ูููุฑุฃูุง ูููุชุจูุง ูููุงุฑู ุจูููุง ููุฑุชุจูุง ูููุฑุจูุง (10/100/1000).",
    time: "ุฃุณุจูุน (3 ุญุตุต + ุชุฏุฑูุจ ููุฒูู)",
    responsible: "ุงููุนูู + ุงูุทุงูุจ",
    tool: "ุงุฎุชุจุงุฑ ูุตูุฑ (5โ10 MCQ) + ุจุทุงูุฉ ุฎุฑูุฌ + ููุงุญุธุฉ ุฃุฏุงุก",
    proceduresTreat: "ุชุดุฎูุต ูุจูู (5 ุฃุณุฆูุฉ).\nููุฐุฌุฉ ูุญุณูุณ/ุชูุซูู/ุฑูุฒู.\nุชุฏุฑูุจ ูุชุฏุฑุฌ ุนูู: ูุฑุงุกุฉ/ุชุญููู/ููุงุฑูุฉ/ุชูุฑูุจ.\nุนูุงุฌ ุฃุฎุทุงุก ุงููููุฉ ุงูููุฒููุฉ.\nุชูููู ุฎุชุงูู ุฃุณุจูุนู.",
    proceduresEnrich: "ุชุญุฏูุงุช ูุฑุงุกุฉ/ุชุญููู ุจุตูุบ ูุชุนุฏุฏุฉ.\nูุณุงุฆู ููุงุฑูุฉ ูุชุฑุชูุจ ูุน ุชุจุฑูุฑ.\nุชูุฑูุจ ูู ุณูุงู ุญูุงุชู (ุชูุฏูุฑ/ูุนููููุฉ).\nุณุคุงู ูุงูุณ ุฃุนูู + ุชูุณูุฑ."
  },
  counting: {
    objective: "ูุนุฏ ุถูู ุฃุฑุจุน ููุงุฒู (ุชุตุงุนุฏู/ุชูุงุฒูู/ููุฒู 2ุ5ุ10ุ100ุ1000) ููุณุชุฎุฏู ุงูุนุฏ ุจุงูุงุซููู ูุชุญุฏูุฏ ุงูุฒูุฌู ูุงููุฑุฏู.",
    time: "3 ุญุตุต ูุตูุฑุฉ ุฏุงุฎู ุงูุฃุณุจูุน",
    responsible: "ุงููุนูู + ุงูุทุงูุจ",
    tool: "ุจุทุงูุฉ ุฎุฑูุฌ + ูุดุงุท ุดููู + ุงุฎุชุจุงุฑ ูุตูุฑ",
    proceduresTreat: "ุชุฏุฑูุจ ุดููู ูููู (ุฏูููุฉ ูุงุญุฏุฉ).\nุฃุดุฑุทุฉ ุฃุนุฏุงุฏ/ุจุทุงูุงุช ุนุฏ ููุฒู.\nุชุซุจูุช ุงูุฒูุฌู/ุงููุฑุฏู ุนุจุฑ ููุท ุงูุขุญุงุฏ.\nุชูููู ุณุฑูุน ูููู (ุณุคุงู ูุงุญุฏ).",
    proceduresEnrich: "ุชุญุฏูุงุช ุนุฏ ููุฒู ุนูุณู.\nูุณุงุฆู ุชุทุจูููุฉ (ุงูุฒูู/ุงููููุฏ) ุชุนุชูุฏ ุงูุนุฏ.\nุชูููุฏ ุฃููุงุท ุนุฏุฏูุฉ ูู ุงูุนุฏ ุงูููุฒู."
  },
  fractions: {
    objective: "ูุตู ูุณูุฑ ุงููุญุฏุฉ ููุถุงุนูุงุชูุง ูุฃุฌุฒุงุก ูู ุงููู/ูุฌููุนุฉุ ูููุฑุฃูุง ูููุชุจูุง ูููุซููุง ุนูู ุฎุท ุงูุฃุนุฏุงุฏ ูููุงุฑู ููุฑุชุจ ุงููุณูุฑ ุฐุงุช ููุณ ุงูุจุณุท ุฃู ุงูููุงู.",
    time: "ุฃุณุจูุน (3 ุญุตุต + ูุฑูุฉ ุนูู)",
    responsible: "ุงููุนูู + ุงูุทุงูุจ",
    tool: "ูุฑูุฉ ุนูู + ุงุฎุชุจุงุฑ MCQ + ููุงุญุธุฉ ููุงุฐุฌ",
    proceduresTreat: "ุชูุซูู ุจุดุฑุงุฆุท/ุฏูุงุฆุฑ ูุณูุฑ.\nุฑุจุท (ูุณูุฑ ุงููุญุฏุฉ โ ูุถุงุนูุงุชูุง).\nุชูุซูู ุนูู ุฎุท ุงูุฃุนุฏุงุฏ.\nููุงุฑูุฉ (ููุณ ุงูููุงู/ููุณ ุงูุจุณุท) ุจุงูููุงุฐุฌ.\nุงุฎุชุจุงุฑ ุฃุณุจูุนู.",
    proceduresEnrich: "ุชุญุฏูุงุช ููุงุฑูุฉ ูุชุฑุชูุจ 3 ูุณูุฑ.\nูุณุงุฆู ููุธูุฉ ุนูู ุงููุณูุฑ ูู ุณูุงู.\nุชุจุฑูุฑ: ููุงุฐุง ูุฐุง ุงููุณุฑ ุฃูุจุฑุ"
  },
  addsub: {
    objective: "ูุฌูุน ููุทุฑุญ ุฃุนุฏุงุฏูุง ุถูู ุซูุงุซ ููุงุฒู (ูุน/ุจุฏูู ุฅุนุงุฏุฉ ุงูุชุฌููุน) ููุญู ูุณุงุฆู ูู ุฎุทูุฉ ุฃู ุฎุทูุชูู ุนูู ุงูุฌูุน ูุงูุทุฑุญ ูููุณุฑ ุงูุญู.",
    time: "ุฃุณุจูุน (4 ุญุตุต)",
    responsible: "ุงููุนูู + ุงูุทุงูุจ",
    tool: "ุงุฎุชุจุงุฑ ุฃุณุจูุนู + ุชุญูู ุฐุงุชู + ุจุทุงูุฉ ุฎุฑูุฌ",
    proceduresTreat: "ุชุซุจูุช ุงููููุฉ ุงูููุฒููุฉ ูู ุงูุฎูุงุฑุฒููุฉ.\nุชุฏุฑูุจ ุนูู ุฅุนุงุฏุฉ ุงูุชุฌููุน ุจุฎุทูุงุช ูุงุถุญุฉ.\nุณุคุงูุงู ููุฌูุงู + 5 ูุณุชูู.\nูุณุงุฆู ููุธูุฉ (ุงุฎุชูุงุฑ ุงูุนูููุฉ) + ุชูุณูุฑ.\nุชูููู ุฃุณุจูุนู.",
    proceduresEnrich: "ุงุณุชุฑุงุชูุฌูุงุช ุฐูููุฉ (ุชูููู/ุชุนููุถ).\nูุณุงุฆู ููุธูุฉ ูุฑูุจุฉ (ุฎุทูุชุงู).\nุชูุณูุฑ ุงุณุชุฑุงุชูุฌูุชู ูุชุงุจููุง."
  },
  muldiv: {
    objective: "ูุตู ุนูููุชู ุงูุถุฑุจ ูุงููุณูุฉ ูููุซูููุง ูููููู ุญูุงุฆูููุง ุญุชู 10ร10ุ ููุณุชุฎุฏู ุงูุญูุงุฆู ุงููุฑุชุจุทุฉ ูุฅูุฌุงุฏ ููุงุชุฌ ุงููุณูุฉ ูุงูุชุญูู.",
    time: "ุฃุณุจูุน (4 ุญุตุต + ุชุฏุฑูุจ ููุฒูู)",
    responsible: "ุงููุนูู + ุงูุทุงูุจ + ููู ุงูุฃูุฑ",
    tool: "ุงุฎุชุจุงุฑ ุญูุงุฆู (ุฒููู) + MCQ + ูุดุงุท ุชูุซูู",
    proceduresTreat: "ุชูุซูู ุจุงููุตูููุงุช/ูุฌููุนุงุช ูุชุณุงููุฉ.\nุชุซุจูุช ุญูุงุฆู ุงูุถุฑุจ ุซู ุญูุงุฆู ุงููุณูุฉ ุงููุฑุชุจุทุฉ.\nุชุฏุฑูุจ ูููู ุณุฑูุน (3 ุฏูุงุฆู).\nูุณุงุฆู ููุธูุฉ.\nุงุฎุชุจุงุฑ ุฃุณุจูุนู.",
    proceduresEnrich: "ุงุณุชุฑุงุชูุฌูุงุช: ุงูุชูุฒูุน/ุงููุถุงุนูุงุช.\nูุณุงุฆู ูุงูุณ ุฃุนูู (ุงุฎุชูุงุฑ ูู ูุชุนุฏุฏ).\nุชุญุฏู ุณุฑุนุฉ + ุฏูุฉ ูุน ุชูุณูุฑ."
  },
  relations: {
    objective: "ูููุฒ ุงูุนูุงูุงุช ุจูู ุงูุนูููุงุช ุงูุฃุฑุจุน ููุณุชุฎุฏููุง ููุชุญูู ูู ุงูููุงุชุฌ ูููุชุจ ุฌูููุง ุนุฏุฏูุฉ ุนูู ุงูุนูููุงุช ุงูุฃุฑุจุน ููุญููุง.",
    time: "ุญุตุชุงู + ุชุทุจููุงุช ุฃุณุจูุนูุฉ",
    responsible: "ุงููุนูู + ุงูุทุงูุจ",
    tool: "ุณุคุงู ุชูุณูุฑ + ุงุฎุชุจุงุฑ MCQ",
    proceduresTreat: "ุฑุจุท (ุฌูุนโุทุฑุญ) ู(ุถุฑุจโูุณูุฉ).\nุงูุชุญูู ูู ุงููุงุชุฌ ุจุนูุณ ุงูุนูููุฉ.\nุชุญููู ุงูุฌูุน ุงููุชูุฑุฑ ุฅูู ุถุฑุจ.\nุชูููู: ุณุคุงู ุชุญูู ูุงุญุฏ ูููููุง.",
    proceduresEnrich: "ูุณุงุฆู ุชุญูู ูุชุนุฏุฏุฉ ุงูุทุฑู.\nูุชุงุจุฉ ุฌูู ุนุฏุฏูุฉ ูู ุณูุงู ุญูุงุชู.\nุชุจุฑูุฑ ุงุฎุชูุงุฑ ุงูุนูููุฉ."
  },
  estimation: {
    objective: "ููุฏุฑ ููุงุชุฌ ุงูุฌูุน ูุงูุทุฑุญ ุถูู ุซูุงุซ ููุงุฒู ุจุงุณุชุฎุฏุงู ุงูุชูุฑูุจ ุฃู ุงูุฃุนุฏุงุฏ ุงููุชูุงุบูุฉุ ููุณุชุฎุฏู ุงูุชุฌููุน ููุญุณุงุจ ุงูุฐููู ูู ุงูุถุฑุจุ ููุชุญูู ูู ูุนููููุฉ ุงูููุงุชุฌ.",
    time: "ุญุตุชุงู + ูุดุงุท ูููู (ุฏูููุฉ)",
    responsible: "ุงููุนูู + ุงูุทุงูุจ",
    tool: "ุจุทุงูุฉ ุฎุฑูุฌ + ุงุฎุชุจุงุฑ MCQ",
    proceduresTreat: "ุงูุชูุฑูุจ ูุฃูุฑุจ ุนุดุฑุฉ/ูุฆุฉ.\nุงูุฃุนุฏุงุฏ ุงููุชูุงุบูุฉ (199โ200).\nูุนููููุฉ ุงููุงุชุฌ ูุจู/ุจุนุฏ ุงูุญู.\nุชุทุจููุงุช ูุตูุฑุฉ.\nุงุฎุชุจุงุฑ ุฃุณุจูุนู.",
    proceduresEnrich: "ุชุญุฏูุงุช ุชูุฏูุฑ ูุชุนุฏุฏุฉ (ุฃูุฑุจ).\nุชุจุฑูุฑ: ููุงุฐุง ูุฐุง ุงูุชูุฏูุฑ ููุงุณุจุ\nุญุณุงุจ ุฐููู ุจุซูุงุซุฉ ุนูุงูู."
  },
  patterns: {
    objective: "ูุตู ุฃููุงุทูุง ุบูุฑ ุนุฏุฏูุฉ ููู ุฎุตุงุฆุต (ููู/ุญุฌู/ุดูู/ุงุชุฌุงู) ูุฃููุงุทูุง ุนุฏุฏูุฉ ูููุฏุณูุฉ ูุชูุงููุฉ ููู ุนูููุฉ ูุงุญุฏุฉ ููููุณูุนูุง ููููู ุงููุงูุต.",
    time: "ุญุตุชุงู",
    responsible: "ุงููุนูู + ุงูุทุงูุจ",
    tool: "ูุดุงุท ููุท + ุงุฎุชุจุงุฑ MCQ",
    proceduresTreat: "ุนุฑุถ ููุท โ ุงุณุชูุชุงุฌ ุงููุงุนุฏุฉ ููุธููุง.\nุชูุณูุน ุงูููุท 3 ุฎุทูุงุช.\nุฅููุงู ุนูุงุตุฑ ููููุฏุฉ.\nุชูููู ุณุฑูุน.",
    proceduresEnrich: "ุชุญุฏูุงุช: ุฃูุซุฑ ูู ูุงุนุฏุฉ.\nุงุจุชูุงุฑ ููุท ูุดุฑุญู.\nููุท ููุฏุณู ูุชูุงูู ูุน ุชูุณูุฑ."
  },
  properties: {
    objective: "ูููุฒ ุฎุตุงุฆุต ุงูุนูููุงุช (ูุน ุงูุตูุฑ/ุงููุงุญุฏ) ูุฎุงุตูุฉ ุงูุฅุจุฏุงู ูุงูุชุฌููุน ููุณุชุฎุฏููุง ูุฅูุฌุงุฏ ุงูููุงุชุฌ ููุชุงุจุฉ ุญูุงุฆู.",
    time: "ุญุตุชุงู + ุฏูุฌ ุฏุงุฎู ุงูุฏุฑูุณ",
    responsible: "ุงููุนูู + ุงูุทุงูุจ",
    tool: "ุจุทุงูุฉ ุฎุฑูุฌ + MCQ",
    proceduresTreat: "ุชุซุจูุช ุงูุตูุฑ ูุงููุงุญุฏ.\nุฃูุซูุฉ ุนูู ุงูุฅุจุฏุงู (ุฌูุน/ุถุฑุจ).\nุฃูุซูุฉ ุนูู ุงูุชุฌููุน ููุญุณุงุจ ุงูุฐููู.\nุชูููู ุฃุณุจูุนู.",
    proceduresEnrich: "ุชุญุฏูุงุช ุฐูููุฉ ุชุณุชุฎุฏู ุงูุชุฌููุน.\nุชุทุจูู ูุจุณุท ููุชูุฒูุน (ุชูููู ุนุฏุฏ).\nุชุจุฑูุฑ ุงูุงุณุชุฑุงุชูุฌูุฉ."
  },
  geometry: {
    objective: "ูููุฒ ููุตูู ุงูุฃุดูุงู ุซูุงุฆูุฉ ูุซูุงุซูุฉ ุงูุฃุจุนุงุฏ ูููุงุฑู ุจูููุง ููู ุงูุฎุตุงุฆุตุ ููุตู ุงูุชูุงุซู ููุญุฏุฏ ุฎุท ุชูุงุซู ููุฑุณููุ ูููููู ุฃุดูุงููุง ุฌุฏูุฏุฉ.",
    time: "ุฃุณุจูุน (3 ุญุตุต)",
    responsible: "ุงููุนูู + ุงูุทุงูุจ",
    tool: "ูุดุงุท ูุฑุฒ + MCQ + ูููุฉ ุฑุณู",
    proceduresTreat: "ุจุทุงูุงุช ูุฑุฒ ุฎุตุงุฆุต.\nุชุนุฑูู ุงูุฎุตุงุฆุต (ุฃุถูุงุน/ุฑุคูุณ/ุฃูุฌู).\nุชูุงุซู: ุชุญุฏูุฏ ุฎุท ูุงุญุฏ.\nุชูููู ูุตูุฑ.",
    proceduresEnrich: "ุชุญุฏูุงุช ุชุตููู ูุฑูุจุฉ.\nุงูุชุดุงู ุฃูุซุฑ ูู ุฎุท ุชูุงุซู.\nุจูุงุก ูุฌุณูุงุช ูููุงุฑูุฉ ุฎุตุงุฆุต."
  },
  perimeter_area: {
    objective: "ูุตู ุงููุญูุท ููููุณ ูุญูุท ูุถูุน ุจุงุณุชุฎุฏุงู ุดุจูุฉ ุงููุฑุจุนุงุช ููุญุฏุงุช ุงูุทููุ ููุตู ุงููุณุงุญุฉ ููุฌุฏ/ููุฏุฑ ูุณุงุญุฉ ุดูู ุจุงุณุชุฎุฏุงู ุดุจูุฉ ุงููุฑุจุนุงุช.",
    time: "ุญุตุชุงู + ุชุทุจูู",
    responsible: "ุงููุนูู + ุงูุทุงูุจ",
    tool: "ูุฑูุฉ ุดุจูุฉ + MCQ",
    proceduresTreat: "ูุดุงุท ุดุจูุฉ: ุนุฏู ูุญุฏุงุช ุงููุญูุท.\nุงูุชูููุฒ ุจูู ูุญูุท ููุณุงุญุฉ.\nูุณุงุญุฉ: ุนุฏู ุงููุฑุจุนุงุช.\nุงุฎุชุจุงุฑ ุฃุณุจูุนู.",
    proceduresEnrich: "ูุณุงุฆู ุดุจูุฉ ุฃูุจุฑ.\nุชูุณูุฑ ุงููุฑู ุจูู ุงูููููููู.\nุชุญุฏู: ููุณ ุงููุญูุท ููุณุงุญุงุช ูุฎุชููุฉ."
  },
  measurements: {
    objective: "ูุตู ุงูุฃุทูุงู ูููุฏุฑูุง ูููุงุฑู ููุฑุชุจ ููุฎุชุงุฑ ูุญุฏุงุช ุงูููุงุณ ุงูููุงุณุจุฉ (ููู/ุณู/ู/ูู)ุ ูููุฏุฑ ุงููุชู (ุฌู/ูุฌู) ูุงูุณุนุงุช (ูู/ูุชุฑ) ูููุงุฑู ููุฑุชุจ.",
    time: "ุฃุณุจูุน (3 ุญุตุต)",
    responsible: "ุงููุนูู + ุงูุทุงูุจ",
    tool: "ููุงุญุธุฉ ุนูููุฉ + MCQ",
    proceduresTreat: "ุชูููุฒ ุงููุญุฏุฉ ุงูููุงุณุจุฉ.\nุชูุฏูุฑ ุซู ููุงุณ.\nููุงุฑูุฉ ูุชุฑุชูุจ ููู.\nุชุทุจููุงุช ุญูุงุชูุฉ.\nุงุฎุชุจุงุฑ ุฃุณุจูุนู.",
    proceduresEnrich: "ูุดููุงุช ุชุญููู ุจุณูุทุฉ (ุณูโู).\nุชุญุฏูุงุช ุชุฑุชูุจ ูุน ุชุจุฑูุฑ.\nุชุตููู ุณุคุงู ููุงุณ ูู ุงููุงูุน."
  },
  money_time: {
    objective: "ูููุฒ ูุฆุงุช ุงููููุฏ ููุนุฏ ูููุซู ูููุงุฑู ูุจุงูุบ ุญุชู 9999 ุฑูุงู ููุญู ูุณุงุฆู ูุงููุฉุ ููุฎุชุงุฑ ูุญุฏุงุช ุงูุฒูู ุงูููุงุณุจุฉ ูููุฑุฃ ุงูููุช ูููุชุจู ูููุฏุฑ ุฃุทูุงู ุงููุฏุฏ ููุญุณุจูุง.",
    time: "ุฃุณุจูุน (4 ุญุตุต)",
    responsible: "ุงููุนูู + ุงูุทุงูุจ",
    tool: "ูููุฉ ุชุทุจูููุฉ + MCQ",
    proceduresTreat: "ุชูุซูู ูุจุงูุบ ุจุทุฑู ูุชุนุฏุฏุฉ.\nูุณุงุฆู ุฌูุน/ุทุฑุญ ุจุงููููุฏ.\nูุฑุงุกุฉ ุงูุณุงุนุฉ (ูุงููุฉ/ูุตู/ุฑุจุน/ุฃูุฑุจ 5 ุฏูุงุฆู).\nุญุณุงุจ ูุฏุฉ ุจูู ุญุฏุซูู.\nุงุฎุชุจุงุฑ ุฃุณุจูุนู.",
    proceduresEnrich: "ููุฒุงููุฉ ูุตุบุฑุฉ.\nูุณุงุฆู ุฒูู ูุฑูุจุฉ.\nุชุจุฑูุฑ ุงุฎุชูุงุฑ ุงููุญุฏุฉ ุงูุฒูููุฉ."
  },
  stats: {
    objective: "ูุฌูุน ุจูุงูุงุช ูู ุงูุจูุฆุฉ ูููุธููุง ูู ูุฆุงุช ุจุงุณุชุฎุฏุงู ุฌุฏุงูู ุชูุฑุงุฑูุฉุ ูููุซููุง ุจุงูุฃุนูุฏุฉ ูุงูุฑุณู ุจุงูุฑููุฒ ูุงูููุงุทุ ูููุฑุฃ ุงูุชูุซููุงุช ูููุณุฑูุง.",
    time: "ุญุตุชุงู + ูุดุฑูุน ุตููู",
    responsible: "ุงููุนูู + ุงูุทุงูุจ",
    tool: "ูุดุฑูุน ุจูุงูุงุช + MCQ",
    proceduresTreat: "ุฌูุน ุจูุงูุงุช ุตููุฉ.\nุฌุฏูู ุชูุฑุงุฑู.\nูุฎุทุท ุฃุนูุฏุฉ ุจุณูุท.\nูุฑุงุกุฉ ูุชูุณูุฑ (ุงูุฃูุซุฑ/ุงูุฃูู/ุงููุฑู).\nุงุฎุชุจุงุฑ ุฃุณุจูุนู.",
    proceduresEnrich: "ููุงุฑูุฉ ุชูุซูููู ูููุณ ุงูุจูุงูุงุช.\nุฃุณุฆูุฉ ุงุณุชูุชุงุฌ.\nุชุตููู ุงุณุชุจุงูุฉ ูุตูุฑุฉ."
  }
};

const QUESTION_BANK = {
  numbers4: [
    {q:"ูุง ูููุฉ ุงูุฑูู 7 ูู ุงูุนุฏุฏ 3,742ุ", options:["7","70","700","7000"], a:2, ex:"ุงูุฑูู 7 ูู ููุฒูุฉ ุงููุฆุงุช."},
    {q:"ุฃู ุตูุบุฉ ุชุญููููุฉ ููุนุฏุฏ 5,068ุ", options:["5000 + 600 + 8","5000 + 60 + 8","5000 + 6 + 80","500 + 60 + 8"], a:1, ex:"5 ุขูุงู + 6 ุนุดุฑุงุช + 8 ุขุญุงุฏ."},
    {q:"ุฃู ุนุฏุฏ ุฃูุจุฑุ", options:["4,132","4,312","4,231","4,213"], a:1, ex:"3 ูู ููุฒูุฉ ุงููุฆุงุช ุฃูุจุฑ ูู 1 ู2."},
    {q:"ุฑุชูุจ ุชุตุงุนุฏููุง: 2,105 โ 2,015 โ 2,150 โ 2,051", options:["2,015 ุซู 2,051 ุซู 2,105 ุซู 2,150","2,051 ุซู 2,015 ุซู 2,105 ุซู 2,150","2,150 ุซู 2,105 ุซู 2,051 ุซู 2,015","2,105 ุซู 2,015 ุซู 2,051 ุซู 2,150"], a:0, ex:"ููุงุฑู ุงูุขูุงู ุซู ุงููุฆุงุช ุซู ุงูุนุดุฑุงุช ุซู ุงูุขุญุงุฏ."},
    {q:"ูุฑูุจ 3,478 ูุฃูุฑุจ ูุฆุฉ.", options:["3,400","3,450","3,500","3,600"], a:2, ex:"78 โฅ 50 ุฅุฐู ุฅูู 3,500."},
    {q:"ูุฑูุจ 6,149 ูุฃูุฑุจ ุฃูู.", options:["6,000","6,100","7,000","5,000"], a:0, ex:"149 ุฃูู ูู 500 ุฅุฐู ุฅูู 6,000."},
    {q:"ุฃู ูุตู ููุซู ุงูุนุฏุฏ 1,234ุ", options:["1 ูุฆุฉ ู2 ุนุดุฑุงุช ู3 ุขุญุงุฏ ู4 ุขูุงู","1 ุฃูู ู2 ูุฆุฉ ู3 ุนุดุฑุฉ ู4 ุขุญุงุฏ","1 ุฃูู ู2 ุนุดุฑุฉ ู3 ูุฆุฉ ู4 ุขุญุงุฏ","1 ุฃูู ู2 ูุฆุฉ ู3 ุขุญุงุฏ ู4 ุนุดุฑุงุช"], a:1, ex:"ููุฒูุฉ ุงูุขูุงู ุซู ุงููุฆุงุช ุซู ุงูุนุดุฑุงุช ุซู ุงูุขุญุงุฏ."},
    {q:"ุงูุนุฏุฏ ุงูุฐู ูุทุงุจู (ุฃุฑุจุนุฉ ุขูุงู ูุซูุงุซูุฆุฉ ูุณุชุฉ) ูู:", options:["4,036","4,306","4,360","4,003"], a:1, ex:"4 ุขูุงู + 3 ูุฆุฉ + 6 ุขุญุงุฏ."},
  ],
  counting: [
    {q:"ุฃููู ุงูุนุฏ ุงูููุฒู ุจุงูุฎูุณุงุช: 35ุ 40ุ 45ุ ____", options:["46","50","55","60"], a:1, ex:"ูุถูู 5 ูู ูุฑุฉ."},
    {q:"ูู ุงูุนุฏุฏ 68 ุฒูุฌู ุฃู ูุฑุฏูุ", options:["ุฒูุฌู","ูุฑุฏู","ูุง ูููู","ููุณ ุนุฏุฏูุง"], a:0, ex:"ุงูุขุญุงุฏ 8 โ ุฒูุฌู."},
    {q:"ุฃููู ุงูุนุฏ ุจุงูุนุดุฑุงุช: 120ุ 130ุ 140ุ ____", options:["141","145","150","160"], a:2, ex:"ูุถูู 10."},
    {q:"ุฃููู ุงูุนุฏ ุจุงููุฆุงุช: 900ุ 1000ุ 1100ุ ____", options:["1110","1200","2000","1010"], a:1, ex:"ูุถูู 100."},
    {q:"ุฃู ุนุฏุฏ ููุจู ุงููุณูุฉ ุนูู 2ุ", options:["37","41","58","63"], a:2, ex:"ุงูุขุญุงุฏ ุฒูุฌู โ ููุจู ุงููุณูุฉ ุนูู 2."},
    {q:"ุฃููู ุงูุนุฏ ุจุงูุฃููู: 2000ุ 3000ุ 4000ุ ____", options:["4500","5000","6000","4100"], a:1, ex:"ูุถูู 1000."},
  ],
  fractions: [
    {q:"ุฃู ูุณุฑ ููุซู ุฌุฒุกูุง ูุงุญุฏูุง ูู 4 ุฃุฌุฒุงุก ูุชุณุงููุฉุ", options:["1/2","1/3","1/4","4/1"], a:2, ex:"ูุณูุฑ ุงููุญุฏุฉ ูููู ุงูุจุณุท 1."},
    {q:"ุงููุณุฑ ุงูุฐู ููุซู 3 ุฃุฌุฒุงุก ูู 8 ูู:", options:["8/3","3/8","1/8","3/4"], a:1, ex:"ุงูุจุณุท ุนุฏุฏ ุงูุฃุฌุฒุงุก ุงููุฃุฎูุฐุฉ."},
    {q:"ุฃู ุฃูุจุฑุ", options:["1/6","1/4","ูุชุณุงููุงู","ูุง ูููู"], a:1, ex:"ูููุง ุตุบุฑ ุงูููุงู ูุจุฑ ูุณุฑ ุงููุญุฏุฉ."},
    {q:"ูุงุฑู: 3/8 ____ 5/8", options:[">","<","=","ูุง ุดูุก"], a:1, ex:"ููุณ ุงูููุงู: ููุงุฑู ุงูุจุณุทูู."},
    {q:"ูุงุฑู: 2/7 ____ 2/5", options:[">","<","=","ูุง ุดูุก"], a:1, ex:"ููุณ ุงูุจุณุท: ุงูุฃุตุบุฑ ููุงููุง ูู ุงูุฃูุจุฑ ูููุฉ."},
    {q:"ุฑุชูุจ ุชุตุงุนุฏููุง: 1/2 ุ 1/3 ุ 1/6", options:["1/2 ุซู 1/3 ุซู 1/6","1/6 ุซู 1/3 ุซู 1/2","1/3 ุซู 1/6 ุซู 1/2","1/6 ุซู 1/2 ุซู 1/3"], a:1, ex:"ูู ูุณูุฑ ุงููุญุฏุฉ: ุงูุฃูุจุฑ ููุงููุง ุฃุตุบุฑ ูููุฉ."},
    {q:"ุฃู ูุณุฑ ูุณุงูู ูุถุงุนู (2 ร 1/5)ุ", options:["1/10","2/5","3/5","1/5"], a:1, ex:"2 ร 1/5 = 2/5."},
    {q:"ูุงุฑู: 4/9 ____ 4/7", options:[">","<","=","ูุง ุดูุก"], a:1, ex:"ููุณ ุงูุจุณุท: ุงูุฃุตุบุฑ ููุงููุง ุฃูุจุฑ."},
  ],
  addsub: [
    {q:"ูุงุชุฌ 348 + 125 = ?", options:["463","473","483","493"], a:1, ex:"348+100=448 ุซู +25=473."},
    {q:"ูุงุชุฌ 602 + 198 = ?", options:["700","790","800","810"], a:2, ex:"602+200=802 ุซู -2=800."},
    {q:"ูุงุชุฌ 740 - 265 = ?", options:["475","485","505","515"], a:0, ex:"740-200=540 ุซู -60=480 ุซู -5=475."},
    {q:"ูุงุชุฌ 500 - 178 = ?", options:["322","332","312","328"], a:0, ex:"500-180=320 ุซู +2=322."},
    {q:"ูุน ุฎุงูุฏ 235 ุฑูุงููุง ูุงุดุชุฑู ุจู79 ุฑูุงููุง. ูู ุจููุ", options:["146","156","164","166"], a:1, ex:"235-79=156."},
    {q:"ูู ููุชุจุฉ 168 ูุชุงุจูุง ุฃุถูู 247 ูุชุงุจูุง. ูู ุงููุฌููุนุ", options:["405","415","425","435"], a:1, ex:"168+247=415."},
    {q:"ูุงุชุฌ 623 - 405 = ?", options:["208","218","228","238"], a:1, ex:"623-400=223 ุซู -5=218."},
    {q:"ุฃู ุนูููุฉ ููุงุณุจุฉ ููุณุฃูุฉ: (ูุงู ุนูุฏู 320 ุซู ุฃุตุจุญ 485)ุ", options:["ุฌูุน","ุทุฑุญ","ุถุฑุจ","ูุณูุฉ"], a:0, ex:"ูุจุญุซ ุนู ุงูุฒูุงุฏุฉ: 320 + ุ = 485."},
  ],
  muldiv: [
    {q:"ูุงุชุฌ 7 ร 6 = ?", options:["36","40","42","48"], a:2, ex:"7ร6=42."},
    {q:"ูุงุชุฌ 9 ร 8 = ?", options:["64","72","81","90"], a:1, ex:"9ร8=72."},
    {q:"ูุงุชุฌ 56 รท 7 = ?", options:["6","7","8","9"], a:2, ex:"56=7ร8."},
    {q:"ูุงุชุฌ 48 รท 6 = ?", options:["6","7","8","9"], a:2, ex:"48=6ร8."},
    {q:"ุฅุฐุง ูุงู 6 ร 5 = 30 ุฅุฐู 30 รท 5 = ?", options:["5","6","7","8"], a:1, ex:"ุงูุนูููุฉ ุงูุนูุณูุฉ ููุถุฑุจ."},
    {q:"ููุซู: 4 ูุฌููุนุงุช ูู ูู ูุฌููุนุฉ 3. ุงูุฌููุฉ ุงูุถุฑุจูุฉ:", options:["4+3=7","4ร3=12","4รท3=1","3-4=-1"], a:1, ex:"ูุฌููุนุงุช ูุชุณุงููุฉ โ ุถุฑุจ."},
    {q:"ูุงุชุฌ 8 ร 0 = ?", options:["0","8","1","ูุง ูููู"], a:0, ex:"ุฃู ุนุฏุฏ ร 0 = 0."},
    {q:"ูุงุชุฌ 0 รท 5 = ?", options:["0","5","1","ูุง ูููู"], a:0, ex:"ุตูุฑ ููุณูู ุนูู ุนุฏุฏ โ0 ูุณุงูู 0."},
    {q:"24 ูุทุนุฉ ููุฒุนุช ุจุงูุชุณุงูู ุนูู 6 ุฃุทูุงู. ููู ุทูู:", options:["3","4","5","6"], a:1, ex:"24รท6=4."},
    {q:"ุฃู ุฌููุฉ ูุณูุฉ ูุฑุชุจุทุฉ ุจู 8ร3=24ุ", options:["24รท3=8","24รท8=4","24รท6=4","24รท8=5"], a:0, ex:"24รท3=8 ุฃู 24รท8=3."},
  ],
  relations: [
    {q:"ููุชุญูู ูู ุตุญุฉ 7ร4=28 ุงุฎุชุฑ ุงูุฌููุฉ ุงูููุงุณุจุฉ:", options:["28+7=35","28รท7=4","28-4=24","7รท28=4"], a:1, ex:"ุงูุชุญูู ูููู ุจุนูุณ ุงูุนูููุฉ."},
    {q:"ุงูุฌููุฉ ุงูุถุฑุจูุฉ ุงูููุงูุฆุฉ ูู 5+5+5+5 ูู:", options:["5ร5=25","4ร5=20","5ร4=9","4+5=9"], a:1, ex:"ุฌูุน ูุชูุฑุฑ โ ุถุฑุจ."},
    {q:"24รท6 ูููู ุฅูุฌุงุฏู ุจุงูุทุฑุญ ุงููุชูุฑุฑ. ูู ูุฑุฉ ูุทุฑุญ 6 ูู 24 ุญุชู ูุตู ุฅูู 0ุ", options:["2","3","4","6"], a:2, ex:"24โ18โ12โ6โ0 (4 ูุฑุงุช)."},
    {q:"ุฃู ุฌููุฉ ุนุฏุฏูุฉ ุชูุซู: 3 ุฃููุงุณ ูู ูู ููุณ 9 ูุฑุงุชุ", options:["3+9=12","3ร9=27","9-3=6","27รท9=1"], a:1, ex:"ูุฌููุนุงุช ูุชุณุงููุฉ โ ุถุฑุจ."},
    {q:"ุฅุฐุง ูุงู 8ร3=24 ูุฃู ุนุจุงุฑุฉ ุตุญูุญุฉุ", options:["24รท8=3","24รท3=6","8รท24=3","24-8=3"], a:0, ex:"ุงููุณูุฉ ุนูุณ ุงูุถุฑุจ."},
    {q:"ุงุฎุชุฑ ุงูุฌููุฉ ุงูุนุฏุฏูุฉ ุงูุตุญูุญุฉ ููุณุฃูุฉ: ุจูู 18 ูู 45", options:["45-18=27","45+18=63","45ร18","45รท18"], a:0, ex:"ุจูู โ ุทุฑุญ."},
  ],
  estimation: [
    {q:"ูุฏูุฑ 398 + 205 ูุฃูุฑุจ ูุฆุฉ.", options:["500","600","700","800"], a:1, ex:"400+200=600."},
    {q:"ูุฏูุฑ 742 - 198 ูุฃูุฑุจ ูุฆุฉ.", options:["400","500","600","700"], a:1, ex:"700-200=500."},
    {q:"ุจุงุณุชุฎุฏุงู ุงูุฃุนุฏุงุฏ ุงููุชูุงุบูุฉ: 199 + 302 โ", options:["400","450","500","550"], a:2, ex:"200+300=500."},
    {q:"ุฃู ุชูุฏูุฑ ุฃูุฑุจ ูู 486 + 311 ุ", options:["700","800","900","1000"], a:1, ex:"โ 500+300=800."},
    {q:"ุงุญุณุจ ุฐููููุง: 2ร5ร4 = ?", options:["20","30","40","50"], a:2, ex:"(2ร5)=10 ุซู 10ร4=40."},
    {q:"ูู 297 + 312 = 609 ูุงุชุฌ ูุนูููุ", options:["ูุนู","ูุง","ูุง ูููู","ุฃุญูุงููุง"], a:0, ex:"300+300โ600 ูุฑูุจ ูู 609."},
    {q:"ูุฏูุฑ 650 - 298 ุจุงุณุชุฎุฏุงู ุงูุชูุฑูุจ.", options:["200","300","400","500"], a:1, ex:"650-300โ350 ุฃูุฑุจ ูู 300 ูู 400 ูู ุงูุฎูุงุฑุงุชุ (ุงูุฃูุฑุจ 300/400ุ ูุฎุชุงุฑ 300 ูุชูุฏูุฑ ุฃูู)."},
    {q:"ุงุฎุชุฑ ูุงุชุฌูุง ุชูุฑูุจููุง ูู 512 + 389.", options:["800","900","1000","1100"], a:1, ex:"โ 500+400=900."},
  ],
  patterns: [
    {q:"ุฃููู ุงูููุท: 4ุ 8ุ 12ุ 16ุ ____", options:["18","20","22","24"], a:1, ex:"ุงููุงุนุฏุฉ: +4."},
    {q:"ุฃููู ุงูููุท: 30ุ 27ุ 24ุ 21ุ ____", options:["19","18","17","16"], a:1, ex:"ุงููุงุนุฏุฉ: -3."},
    {q:"ุฃููู ุงูููุท: 2ุ 4ุ 8ุ 16ุ ____", options:["18","24","32","34"], a:2, ex:"ุงููุงุนุฏุฉ: ร2."},
    {q:"ูุงุนุฏุฉ ุงูููุท: 5ุ 10ุ 15ุ 20 ูู:", options:["+3","+5","-5","ร2"], a:1, ex:"ูุถูู 5."},
    {q:"ููุท ุบูุฑ ุนุฏุฏู: ูุจูุฑุ ุตุบูุฑุ ูุจูุฑุ ุตุบูุฑุ ____", options:["ูุจูุฑ","ุตุบูุฑ","ุฃุทูู","ุฃูุตุฑ"], a:1, ex:"ูุชูุฑุฑ (ูุจูุฑ/ุตุบูุฑ)."},
    {q:"ููู: ุฃุญูุฑุ ุฃุฒุฑูุ ุฃุญูุฑุ ุฃุฒุฑูุ ____", options:["ุฃุฎุถุฑ","ุฃุตูุฑ","ุฃุญูุฑ","ุฃุณูุฏ"], a:2, ex:"ูุชูุฑุฑ (ุฃุญูุฑ/ุฃุฒุฑู)."},
    {q:"ุฃููู ุงูููุท: 100ุ 200ุ 300ุ ____", options:["350","400","500","600"], a:1, ex:"ุงููุงุนุฏุฉ: +100."},
    {q:"ุฃู ุนุฏุฏ ููููุฏุ 9ุ 12ุ __ุ 18 (ูุงุนุฏุฉ +3)", options:["14","15","16","17"], a:1, ex:"9+3=12 ุซู 15 ุซู 18."},
  ],
  properties: [
    {q:"ูุงุชุฌ 345 + 0 = ?", options:["0","345","35","340"], a:1, ex:"ุฅุถุงูุฉ ุงูุตูุฑ ูุง ุชุบูุฑ ุงูุนุฏุฏ."},
    {q:"ูุงุชุฌ 0 ร 9 = ?", options:["0","9","1","ูุง ูููู"], a:0, ex:"ุงูุถุฑุจ ูู ุงูุตูุฑ ูุณุงูู 0."},
    {q:"ูุงุชุฌ 7 ร 1 = ?", options:["1","7","8","0"], a:1, ex:"ุงูุถุฑุจ ูู 1 ูุง ูุบูุฑ ุงูุนุฏุฏ."},
    {q:"ูุงุชุฌ 24 รท 1 = ?", options:["1","0","24","12"], a:2, ex:"ุงููุณูุฉ ุนูู 1 ูุง ุชุบูุฑ ุงูุนุฏุฏ."},
    {q:"ุฃู ุฌููุฉ ุชูุซู ุฎุงุตูุฉ ุงูุฅุจุฏุงู ูู ุงูุฌูุนุ", options:["8+5=5+8","8+5=13+0","8+5=8+6","8+5=8ร5"], a:0, ex:"ูุจุฏูู ุชุฑุชูุจ ุงูุญุฏููู."},
    {q:"ุฃู ุฌููุฉ ุชูุซู ุฎุงุตูุฉ ุงูุฅุจุฏุงู ูู ุงูุถุฑุจุ", options:["4ร7=7ร4","4ร7=28+0","4ร7=4ร8","7ร4=7+4"], a:0, ex:"ูุจุฏูู ุชุฑุชูุจ ุงูุนุงูููู."},
    {q:"ุจุงุณุชุฎุฏุงู ุงูุชุฌููุน: 3ร(4ร5)=ุ", options:["12","15","60","75"], a:2, ex:"(4ร5)=20 ุซู 3ร20=60."},
    {q:"ุชูููู ูุจุณุท: 6ร12 ูุณุงูู:", options:["6ร10 + 6ร2","6ร10 - 6ร2","(6+12)ร2","6+12+2"], a:0, ex:"ุชูุฒูุน ูุจุณุท ุนุจุฑ ุงูุชูููู."},
  ],
  geometry: [
    {q:"ุฃู ุดูู ูู 3 ุฃุถูุงุนุ", options:["ูุฑุจุน","ูุซูุซ","ุฏุงุฆุฑุฉ","ูุณุชุทูู"], a:1, ex:"ุงููุซูุซ ูู 3 ุฃุถูุงุน."},
    {q:"ุฃู ุดูู ูู 4 ุฃุถูุงุน ูุชุณุงููุฉุ", options:["ูุณุชุทูู","ูุฑุจุน","ูุซูุซ","ุฏุงุฆุฑุฉ"], a:1, ex:"ุงููุฑุจุน ุฃุถูุงุนู ูุชุณุงููุฉ."},
    {q:"ูู ุฑุฃุณูุง ูููุณุชุทููุ", options:["3","4","5","6"], a:1, ex:"ูููุณุชุทูู 4 ุฑุคูุณ."},
    {q:"ุฃู ูุฌุณู ูู 6 ุฃูุฌู ูุฑุจุนุฉุ", options:["ูุฑุฉ","ููุนุจ","ูุฎุฑูุท","ุฃุณุทูุงูุฉ"], a:1, ex:"ุงูููุนุจ."},
    {q:"ุฃู ูุฌุณู ูู ูุฌู ุฏุงุฆุฑู ูุงุญุฏ ูููุฉ ูุงุญุฏุฉุ", options:["ุฃุณุทูุงูุฉ","ูุฎุฑูุท","ูุฑุฉ","ููุนุจ"], a:1, ex:"ุงููุฎุฑูุท."},
    {q:"ุนุฏุฏ ุฎุทูุท ุงูุชูุงุซู ูููุฑุจุน ูู:", options:["1","2","3","4"], a:3, ex:"ุฃููู ูุฑุฃุณู ููุทุฑุงู."},
    {q:"ุฃู ุดูู ุซูุงุฆู ุงูุฃุจุนุงุฏ ููุณ ูู ุฃุถูุงุนุ", options:["ุฏุงุฆุฑุฉ","ูุฑุจุน","ูุซูุซ","ูุณุชุทูู"], a:0, ex:"ุงูุฏุงุฆุฑุฉ."},
    {q:"ุฃู ูุฌุณู ูู ูุฌูุงู ุฏุงุฆุฑูุงู ูุณุทุญ ููุญููุ", options:["ุฃุณุทูุงูุฉ","ูุฎุฑูุท","ูุฑุฉ","ูุฑู"], a:0, ex:"ุงูุฃุณุทูุงูุฉ."},
  ],
  perimeter_area: [
    {q:"ูุญูุท ูุฑุจุน ุทูู ุถูุนู 5 ุณู ูุณุงูู:", options:["10","15","20","25"], a:2, ex:"4ร5=20."},
    {q:"ูุญูุท ูุณุชุทูู ุทููู 8 ุณู ูุนุฑุถู 3 ุณู ูุณุงูู:", options:["11","16","22","24"], a:2, ex:"2ร(8+3)=22."},
    {q:"ูุณุงุญุฉ ูุณุชุทูู ุนูู ุดุจูุฉ 3ร4 ูุฑุจุนุงุช ุชุณุงูู:", options:["7","10","12","14"], a:2, ex:"3ร4=12 ูุฑุจุนูุง."},
    {q:"ูุณุงุญุฉ ูุฑุจุน 4ร4 ูุฑุจุนุงุช ุชุณุงูู:", options:["8","12","16","20"], a:2, ex:"4ร4=16."},
    {q:"ุฃู ุนุจุงุฑุฉ ุตุญูุญุฉุ", options:["ุงููุญูุท ูููุณ ุฏุงุฎู ุงูุดูู","ุงููุณุงุญุฉ ุชููุณ ุทูู ุงูุฃุถูุงุน","ุงููุณุงุญุฉ ุชููุณ ุฏุงุฎู ุงูุดูู","ุงููุญูุท ูุณุงูู ุนุฏุฏ ุงููุฑุจุนุงุช"], a:2, ex:"ุงููุณุงุญุฉ = ุฏุงุฎู ุงูุดูู."},
    {q:"ุฅุฐุง ูุงู ูุญูุท ุดูู ุนูู ุดุจูุฉ = 14 ูุญุฏุฉุ ููุฐุง ูุนูู:", options:["ุนุฏู ุงููุฑุจุนุงุช ุฏุงุฎู ุงูุดูู =14","ูุฌููุน ุฃุทูุงู ุงูุฃุถูุงุน =14","ุนุฏุฏ ุงูุฃุถูุงุน =14","ุงููุณุงุญุฉ=14"], a:1, ex:"ุงููุญูุท = ูุฌููุน ุฃุทูุงู ุงูุฃุถูุงุน."},
  ],
  measurements: [
    {q:"ูุญุฏุฉ ููุงุณุจุฉ ูุทูู ููู ูู:", options:["ูู","ู","ุณู","ูุชุฑ"], a:2, ex:"ุงูุฃุทูุงู ุงูุตุบูุฑุฉ ุจุงูุณูุชููุชุฑ."},
    {q:"ูุญุฏุฉ ููุงุณุจุฉ ููุณุงูุฉ ุจูู ูุฏููุชูู ูู:", options:["ููู","ุณู","ู","ูู"], a:3, ex:"ุงููุณุงูุงุช ุงููุจูุฑุฉ ุจุงููููููุชุฑ."},
    {q:"ูุญุฏุฉ ููุงุณุจุฉ ููุชูุฉ ุจุฑุชูุงูุฉ ูู:", options:["ุฌุฑุงู","ูุฌู","ูุชุฑ","ุณู"], a:0, ex:"ุงููุชู ุงูุตุบูุฑุฉ ุจุงูุฌุฑุงู."},
    {q:"ูุญุฏุฉ ููุงุณุจุฉ ููุชูุฉ ุทูู ูู:", options:["ุฌุฑุงู","ูุฌู","ูู","ุณู"], a:1, ex:"ูุชูุฉ ุงูุฃุดุฎุงุต ุจุงูููููุฌุฑุงู."},
    {q:"ูุญุฏุฉ ููุงุณุจุฉ ูุณุนุฉ ุฒุฌุงุฌุฉ ูุงุก ูู:", options:["ูู","ูุชุฑ","ุฌุฑุงู","ูู"], a:1, ex:"ุงูุณุนุงุช ุงููุจูุฑุฉ ุจุงููุชุฑ."},
    {q:"ูุญุฏุฉ ููุงุณุจุฉ ูุณุนุฉ ููุนูุฉ ุฏูุงุก ูู:", options:["ูุชุฑ","ูู","ูุฌู","ู"], a:1, ex:"ุงูุณุนุงุช ุงูุตุบูุฑุฉ ุจุงููููููุชุฑ."},
    {q:"ุฑุชูุจ ุชุตุงุนุฏููุง: 80 ุณูุ 150 ุณูุ 2 ู", options:["2 ู ุซู 150 ุณู ุซู 80 ุณู","80 ุณู ุซู 150 ุณู ุซู 2 ู","150 ุณู ุซู 80 ุณู ุซู 2 ู","80 ุณู ุซู 2 ู ุซู 150 ุณู"], a:1, ex:"2 ู = 200 ุณู."},
    {q:"ุฃู ุฃูุจุฑุ", options:["750 ูู","1 ูุชุฑ","500 ูู","250 ูู"], a:1, ex:"1 ูุชุฑ = 1000 ูู."},
  ],
  money_time: [
    {q:"ุฃู ูุฆุฉ ูุฑููุฉ ุชุณุงูู 50 ุฑูุงููุงุ", options:["5","10","20","50"], a:3, ex:"ูุฑูุฉ 50 ุฑูุงู."},
    {q:"3 ุนููุงุช ูู ูุฆุฉ 2 ุฑูุงู ู 1 ุนููุฉ ูู ูุฆุฉ 5 ุฑูุงู ุชุณุงูู:", options:["9","10","11","12"], a:2, ex:"2+2+2+5=11."},
    {q:"ูุนู 100 ุฑูุงู ูุงุดุชุฑูุช ุจู 68 ุฑูุงู. ุงูุจุงูู:", options:["22","32","38","42"], a:1, ex:"100-68=32."},
    {q:"ุฃู ุชูุซูู ูุณุงูู 37 ุฑูุงููุงุ", options:["20+10+5+2","20+10+2+2","10+10+10+5","50-10-2"], a:0, ex:"20+10+5+2=37."},
    {q:"ุงูููุช 3:30 ูููุฑุฃ:", options:["ุงูุซุงูุซุฉ ุฅูุง ุฑุจุน","ุงูุซุงูุซุฉ ูุงูุฑุจุน","ุงูุซุงูุซุฉ ูุงููุตู","ุงูุซุงูุซุฉ ุฅูุง ุฎูุณ"], a:2, ex:"30 ุฏูููุฉ = ูุตู ุณุงุนุฉ."},
    {q:"ุงูููุช 7:15 ูููุฑุฃ:", options:["ุงูุณุงุจุนุฉ ูุงูุฑุจุน","ุงูุณุงุจุนุฉ ูุงููุตู","ุงูุซุงููุฉ ุฅูุง ุฑุจุน","ุงูุณุงุจุนุฉ ุฅูุง ุฑุจุน"], a:0, ex:"15 ุฏูููุฉ = ุฑุจุน ุณุงุนุฉ."},
    {q:"ูุญุฏุฉ ุฒูู ููุงุณุจุฉ ูููุงุณ ูุฏุฉ ุญุตุฉ ุฏุฑุงุณูุฉ:", options:["ุซุงููุฉ","ุฏูููุฉ","ุณุงุนุฉ","ููู"], a:1, ex:"ุงูุญุตุฉ ุชูุงุณ ุจุงูุฏูุงุฆู."},
    {q:"ุจุฏุฃ ูุดุงุท 5:10 ูุงูุชูู 5:45. ุงููุฏุฉ:", options:["25 ุฏูููุฉ","30 ุฏูููุฉ","35 ุฏูููุฉ","40 ุฏูููุฉ"], a:2, ex:"ูู 10 ุฅูู 45 = 35 ุฏูููุฉ."},
    {q:"ุฃู ุฃูุฑุจ ููุฑุงุกุฉ (9:45) ุจุงููููุงุชุ", options:["ุงูุนุงุดุฑุฉ ุฅูุง ุฑุจุน","ุงูุชุงุณุนุฉ ูุงููุตู","ุงูุชุงุณุนุฉ ูุงูุฑุจุน","ุงูุนุงุดุฑุฉ ูุงูุฑุจุน"], a:0, ex:"45 ุฏูููุฉ = ุฅูุง ุฑุจุน."},
    {q:"ุงุฎุชุฑ: 9999 ุฑูุงู ูุนูู ุถูู", options:["ุฃููู ููุท","ูุฆุงุช ููุท","ุฃุฑุจุนุฉ ููุงุฒู","ููุฒูุชุงู"], a:2, ex:"9999 ุนุฏุฏ ูู ุฃุฑุจุน ููุงุฒู."},
  ],
  stats: [
    {q:"ูู ุงูุฌุฏูู ุงูุชูุฑุงุฑูุ ุงูุชูุฑุงุฑ ูุนูู:", options:["ุงุณู ุงููุฆุฉ","ุนุฏุฏ ูุฑุงุช ุญุฏูุซ ุงููุฆุฉ","ููู ุงููุฆุฉ","ุฒูู ุงููุฆุฉ"], a:1, ex:"ุงูุชูุฑุงุฑ ูุณุงูู ุนุฏุฏ ุงููุฑุงุช."},
    {q:"ูู ูุฎุทุท ุงูุฃุนูุฏุฉุ ุงูุนููุฏ ุงูุฃุทูู ูุฏู ุนูู:", options:["ุฃูู ุชูุฑุงุฑ","ุฃูุจุฑ ุชูุฑุงุฑ","ูุง ุดูุก","ุฎุทุฃ"], a:1, ex:"ุงูุฃุทูู = ุงูุฃูุซุฑ."},
    {q:"ุฅุฐุง ูุงู ุงูุชูุงุญ 8 ูุงูููุฒ 5 ูุงููุฑู ูุณุงูู:", options:["2","3","13","40"], a:1, ex:"8-5=3."},
    {q:"ุฃุฏุงุฉ ููุงุณุจุฉ ูุชูุซูู ุจูุงูุงุช ูุฆุงุช ููููุฉ ูู:", options:["ูุฎุทุท ุฃุนูุฏุฉ","ูุนุงุฏูุฉ","ูุณุชููู","ูุซูุซ"], a:0, ex:"ุงููุฎุทุท ููุงุณุจ ุงููุฆุงุช."},
    {q:"ุฌูุน ุงูุจูุงูุงุช ูู ุงูุตู ุซู ุชูุธูููุง ูู ูุฆุงุช ูุณูู:", options:["ุชูุฏูุฑ","ุชุตููู ูุชูุธูู ุจูุงูุงุช","ุถุฑุจ","ุชูุงุซู"], a:1, ex:"ุชูุธูู ุงูุจูุงูุงุช ูู ูุฆุงุช."},
    {q:"ุฅุฐุง ูุงูุช ูุฆุฉ (ุฃ) ุชูุฑุงุฑูุง 6 ููุฆุฉ (ุจ) ุชูุฑุงุฑูุง 6 ูููุง:", options:["ูุชุณุงููุชุงู","ูุฎุชููุชุงู","ูุง ูููู","ุฃูุจุฑ"], a:0, ex:"ููุณ ุงูุชูุฑุงุฑ."},
    {q:"ูุฑุงุกุฉ ุงููุฎุทุท ุชุนูู:", options:["ุฑุณูู ููุท","ุงุณุชุฎุฑุงุฌ ูุนูููุงุช ููู","ุชููููู","ูุตู"], a:1, ex:"ูุณุชูุชุฌ ุฃูุซุฑ/ุฃูู/ูุฑู."},
    {q:"ุฃู ุณุคุงู ุงุณุชูุชุงุฌูุ", options:["ูู ุนุฏุฏ ุทูุงุจ ุงูุชูุงุญุ","ุฃู ุงููุฆุงุช ุฃูุซุฑุ","ูุง ุงุณู ุงููุฆุฉุ","ูุง ููู ุงูุนููุฏุ"], a:1, ex:"ุงุณุชูุชุงุฌ: ุงูุฃูุซุฑ."},
  ]
};

// ุฅุฐุง ุงุญุชุฌุช ุฃุณุฆูุฉ ุฃูุซุฑ ููู ููุงุฑุฉ: ุฃุถู ุนูุงุตุฑ ุฌุฏูุฏุฉ ุฏุงุฎู QUESTION_BANK ุจููุณ ุงูุชูุณูู.

// =========================
// ุฑุณููุงุช ุชูุถูุญูุฉ (ุชุธูุฑ ุชููุงุฆูุงู ุฏุงุฎู ุงูุฃุณุฆูุฉ)
// =========================
const ILLUSTRATIONS = {
  numbers4: `
    <div class="mt-3 rounded-xl border border-slate-200 bg-slate-50 p-3">
      <div class="text-xs text-slate-600 font-extrabold mb-2">ุฎุฑูุทุฉ ุงููููุฉ ุงูููุฒููุฉ</div>
      <div class="grid grid-cols-4 gap-2 text-center text-xs font-extrabold">
        <div class="rounded-lg border border-slate-200 bg-white py-2">ุขุญุงุฏ</div>
        <div class="rounded-lg border border-slate-200 bg-white py-2">ุนุดุฑุงุช</div>
        <div class="rounded-lg border border-slate-200 bg-white py-2">ูุฆุงุช</div>
        <div class="rounded-lg border border-slate-200 bg-white py-2">ุขูุงู</div>
      </div>
    </div>
  `,
  counting: `
    <div class="mt-3 rounded-xl border border-slate-200 bg-slate-50 p-3">
      <div class="text-xs text-slate-600 font-extrabold mb-2">ุฎุท ุงูุฃุนุฏุงุฏ (ููุฒุงุช ุซุงุจุชุฉ)</div>
      <svg viewBox="0 0 320 44" class="w-full h-11 text-slate-700">
        <line x1="10" y1="24" x2="310" y2="24" stroke="currentColor" stroke-width="2" />
        ${Array.from({length:11}).map((_,i)=>`<line x1="${10+i*30}" y1="18" x2="${10+i*30}" y2="30" stroke="currentColor" stroke-width="2"/>`).join("")}
        <path d="M270 10 L310 24 L270 38" fill="none" stroke="currentColor" stroke-width="2"/>
      </svg>
    </div>
  `,
  fractions: `
    <div class="mt-3 rounded-xl border border-slate-200 bg-slate-50 p-3">
      <div class="text-xs text-slate-600 font-extrabold mb-2">ุชูุซูู ูุณุฑ (ุฃุฌุฒุงุก ูุชุณุงููุฉ)</div>
      <div class="grid grid-cols-4 gap-1">
        <div class="h-7 rounded bg-indigo-200"></div>
        <div class="h-7 rounded bg-indigo-200"></div>
        <div class="h-7 rounded bg-indigo-200"></div>
        <div class="h-7 rounded bg-white border border-slate-300"></div>
      </div>
    </div>
  `,
  addsub: `
    <div class="mt-3 rounded-xl border border-slate-200 bg-slate-50 p-3">
      <div class="text-xs text-slate-600 font-extrabold mb-2">ูุฎุทุท (ุฃุฌุฒุงุก-ูู) ููุฌูุน/ุงูุทุฑุญ</div>
      <div class="grid grid-cols-3 gap-2 text-center text-xs font-extrabold">
        <div class="rounded-lg border border-slate-200 bg-white py-2">ุฌุฒุก</div>
        <div class="rounded-lg border border-slate-200 bg-white py-2">ุฌุฒุก</div>
        <div class="rounded-lg border border-slate-200 bg-white py-2">ุงููู</div>
      </div>
    </div>
  `,
  muldiv: `
    <div class="mt-3 rounded-xl border border-slate-200 bg-slate-50 p-3">
      <div class="text-xs text-slate-600 font-extrabold mb-2">ูุตูููุฉ (ุตููู ร ุฃุนูุฏุฉ)</div>
      <div class="grid grid-cols-6 gap-1">
        ${Array.from({length:24}).map(()=>`<div class="h-3 rounded bg-emerald-200"></div>`).join("")}
      </div>
    </div>
  `,
  relations: `
    <div class="mt-3 rounded-xl border border-slate-200 bg-slate-50 p-3">
      <div class="text-xs text-slate-600 font-extrabold mb-2">ุนุงุฆูุฉ ุงูุญูุงุฆู (ุถุฑุจ/ูุณูุฉ)</div>
      <svg viewBox="0 0 220 130" class="w-full h-24">
        <path d="M110 10 L20 110 L200 110 Z" fill="rgba(99,102,241,0.12)" stroke="rgba(99,102,241,0.55)" stroke-width="2"/>
        <circle cx="110" cy="25" r="10" fill="rgba(16,185,129,0.35)"/>
        <circle cx="40" cy="110" r="10" fill="rgba(16,185,129,0.35)"/>
        <circle cx="180" cy="110" r="10" fill="rgba(16,185,129,0.35)"/>
      </svg>
    </div>
  `,
  estimation: `
    <div class="mt-3 rounded-xl border border-slate-200 bg-slate-50 p-3">
      <div class="text-xs text-slate-600 font-extrabold mb-2">ุชูุฑูุจ (ูุจู/ุจุนุฏ)</div>
      <div class="flex items-center justify-between text-xs font-extrabold text-slate-700">
        <span>ุงูุฃูุฑุจ ููุฃุณูู</span>
        <span class="text-slate-400">|</span>
        <span>ุงูุฃูุฑุจ ููุฃุนูู</span>
      </div>
      <div class="mt-2 h-2 rounded-full bg-slate-200 relative">
        <div class="absolute left-1/2 -translate-x-1/2 -top-2 w-2 h-6 rounded bg-indigo-400"></div>
      </div>
    </div>
  `,
  patterns: `
    <div class="mt-3 rounded-xl border border-slate-200 bg-slate-50 p-3">
      <div class="text-xs text-slate-600 font-extrabold mb-2">ููุท ูุชูุฑุฑ</div>
      <div class="flex gap-2">
        <div class="w-7 h-7 rounded bg-rose-200"></div>
        <div class="w-7 h-7 rounded bg-sky-200"></div>
        <div class="w-7 h-7 rounded bg-rose-200"></div>
        <div class="w-7 h-7 rounded bg-sky-200"></div>
      </div>
    </div>
  `,
  properties: `
    <div class="mt-3 rounded-xl border border-slate-200 bg-slate-50 p-3">
      <div class="text-xs text-slate-600 font-extrabold mb-2">ุฎุงุตูุฉ (ุชุจุฏูู/ุชุฌููุน)</div>
      <div class="text-xs font-bold text-slate-700">ูุซุงู: a + b = b + a</div>
      <div class="text-xs text-slate-600 mt-1">ุฑุชูุจ ุงูุญุฏูุฏ โ ุงููุงุชุฌ ูุง ูุชุบูุฑ.</div>
    </div>
  `,
  geometry: `
    <div class="mt-3 rounded-xl border border-slate-200 bg-slate-50 p-3">
      <div class="text-xs text-slate-600 font-extrabold mb-2">ุฃุดูุงู ููุฏุณูุฉ</div>
      <div class="flex gap-3 items-end">
        <div class="w-0 h-0 border-l-[18px] border-r-[18px] border-b-[32px] border-l-transparent border-r-transparent border-b-sky-300"></div>
        <div class="w-8 h-8 bg-emerald-200 rounded"></div>
        <div class="w-10 h-7 bg-amber-200 rounded-xl"></div>
      </div>
    </div>
  `,
  perimeter_area: `
    <div class="mt-3 rounded-xl border border-slate-200 bg-slate-50 p-3">
      <div class="text-xs text-slate-600 font-extrabold mb-2">ูุญูุท/ูุณุงุญุฉ</div>
      <div class="w-full h-14 border-2 border-indigo-300 rounded-lg relative bg-white">
        <div class="absolute -top-3 left-1/2 -translate-x-1/2 text-[11px] font-bold text-slate-600">ุงูุทูู</div>
        <div class="absolute top-1/2 -translate-y-1/2 -right-6 text-[11px] font-bold text-slate-600 rotate-90">ุงูุนุฑุถ</div>
      </div>
    </div>
  `,
  measurements: `
    <div class="mt-3 rounded-xl border border-slate-200 bg-slate-50 p-3">
      <div class="text-xs text-slate-600 font-extrabold mb-2">ููุงุณ (ูุญุฏุงุช)</div>
      <div class="h-3 rounded bg-slate-200 relative overflow-hidden">
        ${Array.from({length:16}).map((_,i)=>`<div class="absolute top-0 bottom-0 w-[2px] bg-slate-400" style="left:${i*6.25}%"></div>`).join("")}
      </div>
      <div class="mt-2 text-xs text-slate-600">ุณู / ู / ูุฌู / ูุชุฑ โฆ</div>
    </div>
  `,
  money_time: `
    <div class="mt-3 rounded-xl border border-slate-200 bg-slate-50 p-3">
      <div class="text-xs text-slate-600 font-extrabold mb-2">ูููุฏ/ููุช</div>
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-full border border-slate-300 bg-white flex items-center justify-center text-xs font-extrabold">๏ทผ</div>
        <svg viewBox="0 0 80 80" class="w-10 h-10">
          <circle cx="40" cy="40" r="34" fill="white" stroke="rgba(100,116,139,0.7)" stroke-width="4"/>
          <line x1="40" y1="40" x2="40" y2="22" stroke="rgba(99,102,241,0.9)" stroke-width="4" stroke-linecap="round"/>
          <line x1="40" y1="40" x2="56" y2="46" stroke="rgba(99,102,241,0.9)" stroke-width="4" stroke-linecap="round"/>
        </svg>
      </div>
    </div>
  `,
  stats: `
    <div class="mt-3 rounded-xl border border-slate-200 bg-slate-50 p-3">
      <div class="text-xs text-slate-600 font-extrabold mb-2">ุชูุซูู ุจูุงูู (ุฃุนูุฏุฉ)</div>
      <div class="flex items-end gap-2 h-14">
        <div class="w-4 h-8 rounded bg-sky-300"></div>
        <div class="w-4 h-12 rounded bg-indigo-300"></div>
        <div class="w-4 h-6 rounded bg-emerald-300"></div>
        <div class="w-4 h-10 rounded bg-rose-300"></div>
      </div>
    </div>
  `
};

function illustrationFor(skillId){
  return ILLUSTRATIONS[skillId] || "";
}


/* =========================
   ุงูุญุงูุฉ ูุงูุชุฎุฒูู
   ========================= */

const STORAGE_KEY = "nafes_g3_app_v1";

const DEFAULT_STATE = {
  info: { schoolName:"", className:"", teacherName:"", termName:"", yearName:"", studentName:"" },
  ui: { tab:"dashboard", defaultTrack:"ุนูุงุฌู", defaultAnswerKey:"hide", footerText:"ุฅุนุฏุงุฏ: ุฃ/ูุงุทูุฉ ูุฒุงุฒู | ููุชูู ูุนููู ููุนููุงุช ุงูุฑูุงุถูุงุช | ุงูููุชูู ุงูุชูุงุนูู" },
  plan: { custom: {} } // custom[track][skillId][field]
};

function safeParse(json, fallback){
  try { return JSON.parse(json) || fallback; } catch(e){ return fallback; }
}

function loadState(){
  const raw = localStorage.getItem(STORAGE_KEY);
  const s = raw ? safeParse(raw, DEFAULT_STATE) : DEFAULT_STATE;
  // Merge (ููู ูุง ุชููุณุฑ ุงูุฅุตุฏุงุฑุงุช)
  return {
    ...DEFAULT_STATE,
    ...s,
    info: { ...DEFAULT_STATE.info, ...(s.info||{}) },
    ui: { ...DEFAULT_STATE.ui, ...(s.ui||{}) },
    plan: { ...DEFAULT_STATE.plan, ...(s.plan||{}), custom: (s.plan && s.plan.custom) ? s.plan.custom : {} }
  };
}

function saveState(){
  localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
}

let state = loadState();

/* =========================
   ุฃุฏูุงุช ูุณุงุนุฏุฉ
   ========================= */

const $ = (id) => document.getElementById(id);

function todayStr(){
  const d = new Date();
  return d.toLocaleDateString("ar-SA-u-nu-arab", { year:"numeric", month:"long", day:"numeric" });
}

function escapeHtml(s){
  return String(s).replace(/[&<>"']/g, (c)=>({ "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;" }[c]));
}

const AR_DIGITS_MAP = {"0":"ู","1":"ูก","2":"ูข","3":"ูฃ","4":"ูค","5":"ูฅ","6":"ูฆ","7":"ูง","8":"ูจ","9":"ูฉ"};
function toArabicDigits(input){
  return String(input).replace(/[0-9]/g, d => AR_DIGITS_MAP[d] || d);
}
function escDisp(s){
  // ููุนุฑุถ ุฏุงุฎู ุงูุตูุญุฉ: ุชุญููู ุงูุฃุฑูุงู + ุญูุงูุฉ HTML
  return escapeHtml(toArabicDigits(s));
}

const LOGO_DATA_URI = "logo.png";
function applyLogo(){
  document.querySelectorAll(".app-logo").forEach(img=>{
    if(!img.getAttribute("src")) img.setAttribute("src", LOGO_DATA_URI);
  });
}

function hashSeed(str){
  let h = 2166136261;
  for (let i=0;i<str.length;i++){
    h ^= str.charCodeAt(i);
    h = Math.imul(h, 16777619);
  }
  return h >>> 0;
}

function mulberry32(a){
  return function(){
    let t = a += 0x6D2B79F5;
    t = Math.imul(t ^ (t >>> 15), t | 1);
    t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
    return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
  };
}

function shuffle(arr, rng){
  const a = arr.slice();
  for (let i = a.length - 1; i > 0; i--){
    const j = Math.floor(rng() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

function getSkillById(id){
  return SKILLS.find(s=>s.id===id);
}

function domainsList(){
  const set = new Set(SKILLS.map(s=>s.domain));
  return ["ุงููู", ...Array.from(set)];
}

function getCustomPlan(track, skillId){
  return (state.plan.custom?.[track]?.[skillId]) || null;
}

function setCustomPlan(track, skillId, field, value){
  if (!state.plan.custom) state.plan.custom = {};
  if (!state.plan.custom[track]) state.plan.custom[track] = {};
  if (!state.plan.custom[track][skillId]) state.plan.custom[track][skillId] = {};
  state.plan.custom[track][skillId][field] = value;
  saveState();
}

function resetPlanCustom(){
  state.plan.custom = {};
  saveState();
}

/* =========================
   ุจูุงุก ุฎุทุฉ (ุนูุงุฌู/ุฅุซุฑุงุฆู)
   ========================= */

function buildPlanRow(track, skill){
  const tpl = PLAN_TEMPLATES[skill.id];
  const target = Number($("planTarget")?.value || 80);
  const indicator = track === "ุฅุซุฑุงุฆู"
    ? `ูุณุจุฉ ุฅุชูุงู โฅ ${Math.max(90, target)}%`
    : `ูุณุจุฉ ุฅุชูุงู โฅ ${target}%`;

  const base = {
    skillTitle: skill.title,
    objective: tpl?.objective || "",
    procedures: track === "ุฅุซุฑุงุฆู" ? (tpl?.proceduresEnrich || "") : (tpl?.proceduresTreat || ""),
    responsible: tpl?.responsible || "ุงููุนูู + ุงูุทุงูุจ",
    time: tpl?.time || "ุฃุณุจูุน",
    indicator,
    tool: tpl?.tool || "ุงุฎุชุจุงุฑ ูุตูุฑ + ุจุทุงูุฉ ุฎุฑูุฌ"
  };

  const custom = getCustomPlan(track, skill.id);
  if (!custom) return base;

  return {
    ...base,
    objective: custom.objective ?? base.objective,
    procedures: custom.procedures ?? base.procedures,
    responsible: custom.responsible ?? base.responsible,
    time: custom.time ?? base.time,
    indicator: custom.indicator ?? base.indicator,
    tool: custom.tool ?? base.tool
  };
}

/* =========================
   ุงุฎุชูุงุฑ ุฃุณุฆูุฉ ุญุณุจ ุงูุฃุณุจูุน (ุซุงุจุชุฉ/ูุชุบูุฑุฉ ุจุงูุฃุณุจูุน)
   ========================= */

function pickQuestions(skillId, week, count){
  const all = QUESTION_BANK[skillId] || [];
  const seed = hashSeed(`${skillId}|${week}|v1`);
  const rng = mulberry32(seed);
  const idx = shuffle([...Array(all.length).keys()], rng);

  const picked = [];
  for (let i=0; i<count; i++){
    if (all.length === 0) break;
    picked.push(all[idx[i % idx.length]]);
  }
  return picked;
}

/* =========================
   ุนุฑุถ ุงูุฃุณุฆูุฉ
   ========================= */

function renderQuestions(questions, showAnswers, skillId){
  const letters = ["ุฃ","ุจ","ุฌ","ุฏ"];
  const illDefault = illustrationFor(skillId);

  const html = questions.map((qq, i)=>{
    const ill = qq.ill || illDefault;
    const illBlock = ill ? `<div class="mt-3">${ill}</div>` : "";

    const opts = (qq.options || []).map((opt, j)=>{
      return `
        <div class="flex items-start gap-2">
          <div class="mt-1 w-5 h-5 rounded-md border border-slate-300 flex items-center justify-center text-xs">${letters[j]||""}</div>
          <div class="text-slate-800">${escDisp(opt)}</div>
        </div>
      `;
    }).join("");

    const answerBlock = showAnswers ? `
      <div class="mt-3 text-sm rounded-xl border border-emerald-100 bg-emerald-50 p-3">
        <div class="font-extrabold text-emerald-900">ุงูุฅุฌุงุจุฉ: ${letters[qq.a]}</div>
        <div class="text-emerald-800 mt-1">${escDisp(qq.ex || "")}</div>
      </div>
    ` : "";

    return `
      <div class="avoid-break rounded-2xl border border-slate-200 p-4">
        <div class="flex items-start justify-between gap-3">
          <div class="font-extrabold text-slate-900">ุณ${toArabicDigits(i+1)}: ${escDisp(qq.q)}</div>
        </div>
        ${illBlock}
        <div class="mt-3 grid sm:grid-cols-2 gap-3 text-sm">
          ${opts}
        </div>
        ${answerBlock}
      </div>
    `;
  }).join("");

  return `<div class="space-y-4">${html}</div>`;
}

function renderFooter(){
  $("footerPreview").innerText = toArabicDigits(state.ui.footerText || "");
}

function renderMetaLine(){
  const info = state.info;
  const parts = [];
  if (info.schoolName) parts.push(`ุงููุฏุฑุณุฉ: ${info.schoolName}`);
  if (info.className) parts.push(`ุงูุตู/ุงูุดุนุจุฉ: ${info.className}`);
  if (info.teacherName) parts.push(`ุงููุนูู: ${info.teacherName}`);
  if (info.termName) parts.push(`ุงููุตู: ${info.termName}`);
  if (info.yearName) parts.push(`ุงูุนุงู: ${info.yearName}`);
  return toArabicDigits(parts.join(" | "));
}

/* =========================
   ุงูุนุฑุถ: ุงูุชุจููุจุงุช
   ========================= */

function setTab(tab){
  state.ui.tab = tab;
  saveState();

  document.querySelectorAll(".tab-btn").forEach(btn=>{
    const active = btn.dataset.tab === tab;
    btn.setAttribute("aria-selected", active ? "true" : "false");
  });

  ["dashboard","plan","training","quiz","bank"].forEach(t=>{
    const el = $("tab-"+t);
    if (!el) return;
    el.classList.toggle("hidden", t !== tab);
  });

  // ุชุญุฏูุซุงุช ุชุจููุจ ูุญุฏุฏ
  if (tab === "plan") renderPlan();
  if (tab === "bank") renderBank();
}

/* =========================
   ุงูุนุฑุถ: ุงูุฎุทุฉ
   ========================= */

function renderPlan(){
  const track = $("planTrack")?.value || state.ui.defaultTrack || "ุนูุงุฌู";
  const domain = $("planDomain")?.value || "ุงููู";
  const q = ($("planSearch")?.value || "").trim();

  $("planMeta").innerText = renderMetaLine();
  $("planMetaTrack").innerText = track;
  $("todayDate").innerText = todayStr();

  const rows = SKILLS
    .filter(s => domain === "ุงููู" ? true : s.domain === domain)
    .filter(s => {
      if (!q) return true;
      const tpl = PLAN_TEMPLATES[s.id];
      const blob = `${s.title} ${(tpl?.objective||"")} ${(tpl?.proceduresTreat||"")} ${(tpl?.proceduresEnrich||"")}`.toLowerCase();
      return blob.includes(q.toLowerCase());
    })
    .map(s => ({ skill: s, row: buildPlanRow(track, s) }));

  $("planBody").innerHTML = rows.map(({skill, row})=>{
    const editable = (field, value) =>
      `<div contenteditable="true" class="min-h-[52px] whitespace-pre-wrap outline-none"
           data-track="${escapeHtml(track)}" data-skill="${escapeHtml(skill.id)}" data-field="${escapeHtml(field)}">${escDisp(value)}</div>`;

    return `
      <tr class="align-top">
        <td class="p-3 border-b border-slate-200">
          <div class="font-extrabold text-slate-900">${escDisp(skill.title)}</div>
          <div class="text-xs text-slate-500 mt-1">${escDisp(skill.domain)}</div>
        </td>
        <td class="p-3 border-b border-slate-200">${editable("objective", row.objective)}</td>
        <td class="p-3 border-b border-slate-200">${editable("procedures", row.procedures)}</td>
        <td class="p-3 border-b border-slate-200">${editable("responsible", row.responsible)}</td>
        <td class="p-3 border-b border-slate-200">${editable("time", row.time)}</td>
        <td class="p-3 border-b border-slate-200">${editable("indicator", row.indicator)}</td>
        <td class="p-3 border-b border-slate-200">${editable("tool", row.tool)}</td>
      </tr>
    `;
  }).join("");

  // ุฑุจุท ุญูุธ ุงูุชุนุฏููุงุช
  $("planBody").querySelectorAll('[contenteditable="true"]').forEach(el=>{
    el.addEventListener("blur", ()=>{
      const t = el.dataset.track;
      const skillId = el.dataset.skill;
      const field = el.dataset.field;
      const value = (el.innerText || "").trim();
      setCustomPlan(t, skillId, field, value);
    });
  });
}

/* =========================
   ุงูุนุฑุถ: ุงูุชุฏุฑูุจ
   ========================= */

function renderTraining(){
  const skillId = $("trainingSkill").value;
  const skill = getSkillById(skillId);
  const week = Number($("trainingWeek").value || 1);
  const track = $("trainingTrack").value;
  const showAnswers = ($("trainingAnswers").value === "show");

  const qset = pickQuestions(skillId, week, 11); // 3+2+5+1
  const recall = qset.slice(0,3);
  const guided = qset.slice(3,5);
  const independent = qset.slice(5,10);
  const exit = qset.slice(10,11);

  $("trainingTitle").innerText = `ุชุฏุฑูุจ ${track}: ${skill.title}`;
  $("trainingMeta").innerText = toArabicDigits(`${renderMetaLine()} | ุงูุฃุณุจูุน: ${week}`);
  $("trainingStudent").innerText = state.info.studentName || "__________";
  $("trainingDate").innerText = todayStr();

  const sections = [
    {title:"1) ุงุณุชุฑุฌุงุน ุณุฑูุน (3 ุฃุณุฆูุฉ)", desc:"ุฃุฌุจ ุจุณุฑุนุฉ โ ุงููุฏู ุชูุดูุท ุงูููุงุฑุฉ.", qs: recall},
    {title:"2) ุชุฏุฑูุจ ููุฌูู (ุณุคุงูุงู)", desc:"ุญู ูุน ุงููุนูู ุซู ุชุญูู.", qs: guided},
    {title:"3) ุชุทุจูู ูุณุชูู (5 ุฃุณุฆูุฉ)", desc:"ุญู ุจููุณู ุซู ุณููู ุงููุฑูุฉ.", qs: independent},
    {title:"4) ุจุทุงูุฉ ุฎุฑูุฌ (ุณุคุงู ูุงุญุฏ)", desc:"ูููุณ ุงูููู ุงูููุงุฆู.", qs: exit},
  ];

  $("trainingContent").innerHTML = sections.map(sec=>`
    <div class="avoid-break rounded-3xl border border-slate-200 p-4">
      <div class="flex items-start justify-between gap-3">
        <div>
          <div class="text-lg font-extrabold text-slate-900">${escDisp(sec.title)}</div>
          <div class="text-sm text-slate-600 mt-1">${escDisp(sec.desc)}</div>
        </div>
      </div>
      <div class="mt-4">
        ${renderQuestions(sec.qs, showAnswers, skillId)}
      </div>
    </div>
  `).join("") + renderFooterBlock();
}

/* =========================
   ุงูุนุฑุถ: ุงูุงุฎุชุจุงุฑ ุงูุฃุณุจูุนู
   ========================= */

function renderQuiz(){
  const skillId = $("quizSkill").value;
  const skill = getSkillById(skillId);
  const week = Number($("quizWeek").value || 1);
  const count = Number($("quizCount").value || 10);
  const showAnswers = ($("quizAnswers").value === "show");

  const qs = pickQuestions(skillId, week, count);

  $("quizTitle").innerText = `ุงุฎุชุจุงุฑ ุฃุณุจูุนู โ ${skill.title}`;
  $("quizMeta").innerText = toArabicDigits(`${renderMetaLine()} | ุงูุฃุณุจูุน: ${week} | ุงูุฒูู ุงูููุชุฑุญ: 10โ15 ุฏูููุฉ`);
  $("quizStudent").innerText = state.info.studentName || "__________";
  $("quizDate").innerText = todayStr();

  const header = `
    <div class="avoid-break rounded-2xl border border-slate-200 p-4">
      <div class="flex items-start justify-between gap-3 mb-3">
        <img class="app-logo w-12 h-12 object-contain rounded-2xl border border-slate-200 bg-white p-1" alt="ุดุนุงุฑ"/>
        <div class="text-sm text-slate-700 font-extrabold">ุงุฎุชุจุงุฑ ุฃุณุจูุนู โ ุงุฎุชูุงุฑ ูู ูุชุนุฏุฏ</div>
      </div>
      <div class="grid sm:grid-cols-3 gap-3 text-sm">
        <div><span class="text-slate-500">ุงููุฏุฑุณุฉ:</span> <span class="font-bold">${escDisp(state.info.schoolName || "__________")}</span></div>
        <div><span class="text-slate-500">ุงูุตู/ุงูุดุนุจุฉ:</span> <span class="font-bold">${escDisp(state.info.className || "__________")}</span></div>
        <div><span class="text-slate-500">ุงููุตู:</span> <span class="font-bold">${escDisp(state.info.termName || "__________")}</span></div>
        <div><span class="text-slate-500">ุงุณู ุงูุทุงูุจ:</span> <span class="font-bold">${escDisp(state.info.studentName || "__________")}</span></div>
        <div><span class="text-slate-500">ุงูุชุงุฑูุฎ:</span> <span class="font-bold">${escDisp(todayStr())}</span></div>
        <div><span class="text-slate-500">ุงููุนูู:</span> <span class="font-bold">${escDisp(state.info.teacherName || "__________")}</span></div>
      </div>
    </div>
  `;

  const body = renderQuestions(qs, false, skillId);

  const answerKey = showAnswers ? `
    <div class="page-break"></div>
    <div class="avoid-break rounded-3xl border border-emerald-200 bg-emerald-50 p-4">
      <div class="text-lg font-extrabold text-emerald-900">ูููุฐุฌ ุงูุฅุฌุงุจุฉ</div>
      <div class="mt-3 grid sm:grid-cols-2 gap-2 text-sm">
        ${qs.map((qq,i)=>`<div class="rounded-xl bg-white border border-emerald-200 p-2">
          <span class="font-extrabold">ุณ${toArabicDigits(i+1)}:</span> <span class="mono">${["ุฃ","ุจ","ุฌ","ุฏ"][qq.a]}</span>
          <div class="text-emerald-800 mt-1">${escDisp(qq.ex||"")}</div>
        </div>`).join("")}
      </div>
    </div>
  ` : "";

  $("quizContent").innerHTML = header + `<div class="mt-4">${body}</div>` + answerKey + renderFooterBlock();
}

/* =========================
   ุงูุนุฑุถ: ุจูู ุงูุฃุณุฆูุฉ
   ========================= */

function renderBank(){
  const skillId = $("bankSkill").value;
  const q = ($("bankSearch").value || "").trim().toLowerCase();
  const skill = getSkillById(skillId);

  const all = (QUESTION_BANK[skillId] || []).filter(qq=>{
    if (!q) return true;
    const blob = `${qq.q} ${qq.options.join(" ")} ${qq.ex||""}`.toLowerCase();
    return blob.includes(q);
  });

  const summary = `
    <div class="rounded-2xl border border-slate-200 p-4">
      <div class="flex items-start justify-between gap-3">
        <img class="app-logo w-12 h-12 object-contain rounded-2xl border border-slate-200 bg-white p-1" alt="ุดุนุงุฑ"/>
        <div>
          <div class="text-xl font-extrabold text-slate-900">${escDisp(skill.title)}</div>
      <div class="text-sm text-slate-600 mt-1">${escDisp(skill.domain)} | ุนุฏุฏ ุงูุฃุณุฆูุฉ: ${toArabicDigits(all.length)}</div>
        </div>
      </div>
    </div>
  `;

  const list = all.map((qq,i)=>`
    <div class="avoid-break rounded-2xl border border-slate-200 p-4">
      <div class="font-extrabold text-slate-900">ุณ${toArabicDigits(i+1)}: ${escDisp(qq.q)}</div>
      <div class="mt-3 grid sm:grid-cols-2 gap-2 text-sm text-slate-800">
        ${qq.options.map((o,idx)=>`<div class="${idx===qq.a ? "font-extrabold text-emerald-800" : ""}">โข ${escDisp(o)}</div>`).join("")}
      </div>
      <div class="mt-3 text-sm text-slate-600">${escDisp(qq.ex||"")}</div>
    </div>
  `).join("");

  $("bankContent").innerHTML = summary + `<div class="mt-4 space-y-4">${list}</div>` + renderFooterBlock();
}

function renderFooterBlock(){
  const ft = state.ui.footerText || "";
  if (!ft.trim()) return "";
  return `
    <div class="mt-6 text-center text-xs text-slate-500">
      <div>${escDisp(ft)}</div>
    </div>
  `;
}

/* =========================
   ุฑุจุท ุนูุงุตุฑ ุงููุงุฌูุฉ
   ========================= */

function hydrateInputs(){
  // Dashboard inputs
  $("schoolName").value = state.info.schoolName;
  $("className").value = state.info.className;
  $("teacherName").value = state.info.teacherName;
  $("termName").value = state.info.termName;
  $("yearName").value = state.info.yearName;
  $("studentName").value = state.info.studentName;

  $("defaultTrack").value = state.ui.defaultTrack;
  $("defaultAnswerKey").value = state.ui.defaultAnswerKey;
  $("footerText").value = state.ui.footerText;

  // Footer preview
  renderFooter();

  // Plan filters
  $("planTrack").innerHTML = `<option value="ุนูุงุฌู">ุนูุงุฌู</option><option value="ุฅุซุฑุงุฆู">ุฅุซุฑุงุฆู</option>`;
  $("planTrack").value = state.ui.defaultTrack || "ุนูุงุฌู";

  $("planDomain").innerHTML = domainsList().map(d=>`<option value="${escapeHtml(d)}">${escapeHtml(d)}</option>`).join("");
  $("planDomain").value = "ุงููู";

  // Skills dropdowns
  const skillOptions = SKILLS.map(s=>`<option value="${escapeHtml(s.id)}">${escapeHtml(s.title)}</option>`).join("");
  ["trainingSkill","quizSkill","bankSkill"].forEach(id => { $(id).innerHTML = skillOptions; });

  // Defaults for answers toggles
  $("quizAnswers").value = state.ui.defaultAnswerKey || "hide";
  $("trainingAnswers").value = state.ui.defaultAnswerKey || "hide";

  // Student placeholders in print sections
  $("trainingStudent").innerText = state.info.studentName || "__________";
  $("quizStudent").innerText = state.info.studentName || "__________";
  $("trainingDate").innerText = todayStr();
  $("quizDate").innerText = todayStr();
}

function bindEvents(){
  // Tabs
  document.querySelectorAll(".tab-btn").forEach(btn=>{
    btn.addEventListener("click", ()=> setTab(btn.dataset.tab));
  });

  // Dashboard data binding
  const infoIds = ["schoolName","className","teacherName","termName","yearName","studentName"];
  infoIds.forEach(id=>{
    $(id).addEventListener("input", ()=>{
      state.info[id] = $(id).value;
      saveState();
      $("planMeta").innerText = renderMetaLine();
      $("trainingStudent").innerText = state.info.studentName || "__________";
      $("quizStudent").innerText = state.info.studentName || "__________";
    });
  });

  $("defaultTrack").addEventListener("change", ()=>{
    state.ui.defaultTrack = $("defaultTrack").value;
    saveState();
    $("planTrack").value = state.ui.defaultTrack;
  });

  $("defaultAnswerKey").addEventListener("change", ()=>{
    state.ui.defaultAnswerKey = $("defaultAnswerKey").value;
    saveState();
    $("quizAnswers").value = state.ui.defaultAnswerKey;
    $("trainingAnswers").value = state.ui.defaultAnswerKey;
  });

  $("footerText").addEventListener("input", ()=>{
    state.ui.footerText = $("footerText").value;
    saveState();
    renderFooter();
  });

  $("btnGoPlan").addEventListener("click", ()=> setTab("plan"));

  // Plan filters
  ["planTrack","planDomain","planSearch","planTarget"].forEach(id=>{
    $(id).addEventListener("input", renderPlan);
    $(id).addEventListener("change", renderPlan);
  });

  $("btnPrintPlan").addEventListener("click", ()=> printOnly("tab-plan"));
  $("btnResetPlan").addEventListener("click", ()=>{
    resetPlanCustom();
    renderPlan();
  });

  // Training
  $("btnGenerateTraining").addEventListener("click", renderTraining);
  $("btnPrintTraining").addEventListener("click", ()=> printOnly("tab-training"));

  // Quiz
  $("btnGenerateQuiz").addEventListener("click", renderQuiz);
  $("btnPrintQuiz").addEventListener("click", ()=> printOnly("tab-quiz"));

  // Bank
  $("bankSkill").addEventListener("change", renderBank);
  $("bankSearch").addEventListener("input", renderBank);
  $("btnPrintBank").addEventListener("click", ()=> printOnly("tab-bank"));

  // Print cover
  $("btnPrintCover").addEventListener("click", ()=>{
    setTab("dashboard");
    printOnly("tab-dashboard");
  });

  // Global print
  $("btnPrint").addEventListener("click", ()=> window.print());

  // Export / Import
  $("btnExport").addEventListener("click", exportData);
  $("importFile").addEventListener("change", importData);
  $("btnResetAll").addEventListener("click", ()=>{
    if (!confirm("ูู ุชุฑูุฏ ุฅุนุงุฏุฉ ุถุจุท ูู ุดูุกุ ุณูุชู ุญุฐู ุงูุชุนุฏููุงุช ูุงูุจูุงูุงุช.")) return;
    localStorage.removeItem(STORAGE_KEY);
    state = loadState();
    hydrateInputs();
    setTab("dashboard");
    renderPlan();
  });
}

function exportData(){
  const blob = new Blob([JSON.stringify(state, null, 2)], {type:"application/json"});
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "nafes_grade3_plan_data.json";
  document.body.appendChild(a);
  a.click();
  a.remove();
  setTimeout(()=>URL.revokeObjectURL(a.href), 1000);
}

function importData(evt){
  const file = evt.target.files?.[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = () => {
    const imported = safeParse(reader.result, null);
    if (!imported) { alert("ููู ุบูุฑ ุตุงูุญ."); return; }
    state = {
      ...DEFAULT_STATE,
      ...imported,
      info: { ...DEFAULT_STATE.info, ...(imported.info||{}) },
      ui: { ...DEFAULT_STATE.ui, ...(imported.ui||{}) },
      plan: { ...DEFAULT_STATE.plan, ...(imported.plan||{}), custom: imported.plan?.custom || {} }
    };
    saveState();
    hydrateInputs();
    setTab(state.ui.tab || "dashboard");
    renderPlan();
    alert("ุชู ุงูุงุณุชูุฑุงุฏ ุจูุฌุงุญ.");
  };
  reader.readAsText(file);
  evt.target.value = "";
}

/* =========================
   ุทุจุงุนุฉ ุชุจููุจ ูุงุญุฏ ููุท
   ========================= */
function printOnly(tabId){
  const tabs = ["tab-dashboard","tab-plan","tab-training","tab-quiz","tab-bank"];
  const prev = state.ui.tab;
  tabs.forEach(id=>{
    const el = $(id);
    if (!el) return;
    el.classList.toggle("hidden", id !== tabId);
  });
  window.print();
  // ุงุฑุฌุน
  tabs.forEach(id=>{
    const el = $(id);
    if (!el) return;
    el.classList.toggle("hidden", id !== ("tab-"+prev));
  });
}

/* =========================
   ุชุดุบูู ุฃููู
   ========================= */
(function init(){
  applyLogo();
  hydrateInputs();
  bindEvents();
  setTab(state.ui.tab || "dashboard");

  // ุชููุฆุฉ ุจูุงูุงุช ุงูุทุจุงุนุฉ ูู ุงูุฎุทุฉ
  $("planMeta").innerText = renderMetaLine();
  $("planMetaTrack").innerText = $("planTrack").value || state.ui.defaultTrack;
  $("todayDate").innerText = todayStr();
})();
</script>
</body>
</html>
